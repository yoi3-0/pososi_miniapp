"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _jsxRuntime = require("../../lib/jsxRuntime");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireDefault(require("react"));

var _getClassName = require("../../helpers/getClassName");

var _classNames = require("../../lib/classNames");

var _masks = require("./masks");

var _useBrowserInfo2 = require("../../hooks/useBrowserInfo");

var _usePlatform = require("../../hooks/usePlatform");

var _browser = require("../../lib/browser");

var _useIsomorphicLayoutEffect = require("../../lib/useIsomorphicLayoutEffect");

var _Caption = _interopRequireDefault(require("../Typography/Caption/Caption"));

var UsersStack = function UsersStack(props) {
  var _useBrowserInfo = (0, _useBrowserInfo2.useBrowserInfo)(),
      system = _useBrowserInfo.system,
      systemVersion = _useBrowserInfo.systemVersion;

  var platform = (0, _usePlatform.usePlatform)();
  var photos = props.photos,
      visibleCount = props.visibleCount,
      size = props.size,
      layout = props.layout,
      children = props.children,
      restProps = (0, _objectWithoutProperties2.default)(props, ["photos", "visibleCount", "size", "layout", "children"]);
  (0, _useIsomorphicLayoutEffect.useIsomorphicLayoutEffect)(function () {
    (0, _masks.createMasks)();
  }, []);
  var othersCount = Math.max(0, photos.length - visibleCount);
  var canShowOthers = othersCount > 0 && size === 'm';
  var photosShown = photos.slice(0, visibleCount);
  var canUseClipPath = true;

  if (system === _browser.System.IOS) {
    canUseClipPath = systemVersion && systemVersion.major >= 12;
  }

  return (0, _jsxRuntime.createScopedElement)("div", (0, _extends2.default)({}, restProps, {
    vkuiClass: (0, _classNames.classNames)((0, _getClassName.getClassName)('UsersStack', platform), "UsersStack--size-".concat(size), "UsersStack--l-".concat(layout), {
      'UsersStack--others': canShowOthers,
      'UsersStack--simple': !canUseClipPath
    })
  }), (0, _jsxRuntime.createScopedElement)("div", {
    vkuiClass: "UsersStack__photos",
    role: "presentation"
  }, photosShown.map(function (photo, i) {
    return (0, _jsxRuntime.createScopedElement)("div", {
      key: i,
      vkuiClass: "UsersStack__photo",
      style: {
        backgroundImage: "url(".concat(photo, ")")
      }
    });
  }), canShowOthers && (0, _jsxRuntime.createScopedElement)(_Caption.default, {
    weight: "medium",
    level: "1",
    vkuiClass: "UsersStack__photo UsersStack__photo--others",
    "aria-hidden": "true"
  }, (0, _jsxRuntime.createScopedElement)("span", null, "+", othersCount))), children && (0, _jsxRuntime.createScopedElement)(_Caption.default, {
    weight: "regular",
    level: "1",
    vkuiClass: "UsersStack__text"
  }, children));
};

UsersStack.defaultProps = {
  photos: [],
  size: 's',
  visibleCount: 3,
  layout: 'horizontal'
};

var _default = /*#__PURE__*/_react.default.memo(UsersStack);

exports.default = _default;
//# sourceMappingURL=UsersStack.js.map