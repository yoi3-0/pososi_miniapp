{"version":3,"sources":["../../../../src/components/View/View.tsx"],"names":["warn","transitionStartEventName","transitionEndEventName","SwipeBackResults","scrollsCache","swipeBackExcludedTags","View","props","e","includes","animationName","activePanel","isBack","state","prevPanel","document","dispatchEvent","window","setState","nextPanel","visiblePanels","animated","undefined","scrolls","scroll","scrollTo","onTransition","from","to","target","propertyName","pickPanel","swipeBackNextPanel","swipeBackResult","fail","onSwipeBackCancel","success","onSwipeBackSuccess","originalEvent","tagName","toLowerCase","platform","configProvider","IOS","isWebView","startX","innerWidth","browserSwipe","onSwipeBack","swipingBack","history","length","swipebackStartX","startT","swipeBackPrevPanel","slice","getScroll","y","swipeBackShift","shiftX","speed","Date","now","getTime","id","prevProps","prevState","popout","blurActiveElement","modal","firstLayerId","panels","map","panel","find","transitionStartEventData","detail","CustomEvent","nextPanelElement","prevPanelElement","scrollTop","waitAnimationFinish","transitionEndHandler","onSwipeBackStart","waitTransitionFinish","swipingBackTransitionEndHandler","transitionMotionEnabled","splitCol","animate","elem","eventHandler","transitionEvent","supported","removeEventListener","name","addEventListener","clearTimeout","transitionFinishTimeout","setTimeout","ANDROID","VKCOM","shouldDisableTransitionMotion","animationEvent","animationFinishTimeout","activeElement","blur","panelNodes","panelId","canUseDOM","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","_1","nav","restProps","hasPopout","hasModal","filter","disableAnimation","modifiers","onMoveX","onEnd","el","calcPanelSwipeStyles","React","Children","toArray","children","Component","SplitColContext","ConfigProviderContext","ScrollContext"],"mappings":"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","sourcesContent":["import React, { Component, CSSProperties, HTMLAttributes, ReactNode, ReactElement } from 'react';\nimport { classNames } from '../../lib/classNames';\nimport { transitionEvent, animationEvent } from '../../lib/supportEvents';\nimport { getClassName } from '../../helpers/getClassName';\nimport { IOS, ANDROID, VKCOM } from '../../lib/platform';\nimport Touch, { TouchEvent } from '../Touch/Touch';\nimport { removeObjectKeys } from '../../lib/removeObjectKeys';\nimport { HasPlatform } from '../../types';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport { withContext } from '../../hoc/withContext';\nimport { ConfigProviderContext, ConfigProviderContextInterface } from '../ConfigProvider/ConfigProviderContext';\nimport { createCustomEvent } from '../../lib/utils';\nimport { SplitColContext, SplitColContextProps } from '../SplitCol/SplitCol';\nimport { AppRootPortal } from '../AppRoot/AppRootPortal';\nimport { canUseDOM, withDOM, DOMProps } from '../../lib/dom';\nimport { ScrollContext, ScrollContextInterface } from '../AppRoot/ScrollContext';\nimport { getNavId, NavIdProps } from '../../lib/getNavId';\nimport { warnOnce } from '../../lib/warnOnce';\n\nconst warn = warnOnce('View');\nexport const transitionStartEventName = 'VKUI:View:transition-start';\nexport const transitionEndEventName = 'VKUI:View:transition-end';\n\nenum SwipeBackResults { fail = 1, success}\n\ninterface Scrolls {\n  [index: string]: number;\n}\n\nexport type TransitionStartEventDetail = {\n  scrolls: Scrolls;\n  from: string;\n  to: string;\n  isBack: boolean;\n};\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls;\n}\n\ntype AnimationEventHandler = (e?: AnimationEvent) => void;\n\ntype TransitionEventHandler = (e?: TransitionEvent) => void;\n\nlet scrollsCache: ViewsScrolls = {};\n\nconst swipeBackExcludedTags = ['input', 'textarea'];\n\nexport interface ViewProps extends HTMLAttributes<HTMLElement>, HasPlatform, NavIdProps {\n  activePanel: string;\n  /**\n   * @deprecated будет удалено в 5.0.0. Используйте одноименное свойство у `SplitLayout`.\n   *\n   * Свойство для отрисовки `Alert`, `ActionSheet` и `ScreenSpinner`.\n   */\n  popout?: ReactNode;\n  /**\n   * @deprecated будет удалено в 5.0.0. Используйте одноименное свойство у `SplitLayout`.\n   *\n   * Свойство для отрисовки `ModalRoot`.\n   */\n  modal?: ReactNode;\n  onTransition?(params: { isBack: boolean; from: string; to: string }): void;\n  /**\n   * callback свайпа назад\n   */\n  onSwipeBack?(): void;\n  /**\n   * callback начала анимации свайпа назад.\n   */\n  onSwipeBackStart?(): void;\n  /**\n   * callback завершения анимации отмененного пользователем свайпа\n   */\n  onSwipeBackCancel?(): void;\n  history?: string[];\n  /**\n   * @ignore\n   */\n  splitCol?: SplitColContextProps;\n  /**\n   * @ignore\n   */\n  configProvider?: ConfigProviderContextInterface;\n  /**\n   * @ignore\n   */\n  scroll?: ScrollContextInterface;\n}\n\nexport interface ViewState {\n  scrolls: Scrolls;\n  animated: boolean;\n  startT?: Date;\n\n  visiblePanels: string[];\n  activePanel: string;\n  isBack: boolean;\n  prevPanel: string;\n  nextPanel: string;\n\n  swipingBack: boolean;\n  swipebackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string;\n  swipeBackPrevPanel: string;\n  swipeBackResult: SwipeBackResults;\n\n  browserSwipe: boolean;\n}\n\nclass View extends Component<ViewProps & DOMProps, ViewState> {\n  constructor(props: ViewProps) {\n    super(props);\n\n    this.state = {\n      scrolls: scrollsCache[getNavId(props)] || {},\n      animated: false,\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n\n      browserSwipe: false,\n    };\n  }\n\n  static defaultProps: Partial<ViewProps> = {\n    history: [],\n  };\n\n  private transitionFinishTimeout: ReturnType<typeof setTimeout>;\n  private animationFinishTimeout: ReturnType<typeof setTimeout>;\n\n  get document() {\n    return this.props.document;\n  }\n\n  get window() {\n    return this.props.window;\n  }\n\n  get panels() {\n    return React.Children.toArray(this.props.children) as ReactElement[];\n  }\n\n  panelNodes: { [id: string]: HTMLDivElement } = {};\n\n  componentWillUnmount() {\n    const id = getNavId(this.props);\n    if (id) {\n      scrollsCache[id] = this.state.scrolls;\n    }\n  }\n\n  componentDidUpdate(prevProps: ViewProps, prevState: ViewState) {\n    this.props.popout && !prevProps.popout && this.blurActiveElement();\n    this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (prevProps.activePanel !== this.props.activePanel && !prevState.swipingBack && !prevState.browserSwipe) {\n      const firstLayerId = this.panels\n        .map((panel) => getNavId(panel.props, warn))\n        .find((id) => id === prevProps.activePanel || id === this.props.activePanel);\n\n      const isBack = firstLayerId === this.props.activePanel;\n\n      this.blurActiveElement();\n\n      this.setState({\n        visiblePanels: [prevProps.activePanel, this.props.activePanel],\n        prevPanel: prevProps.activePanel,\n        nextPanel: this.props.activePanel,\n        activePanel: null,\n        animated: true,\n        scrolls: {\n          ...prevState.scrolls,\n          [prevProps.activePanel]: this.props.scroll.getScroll().y,\n        },\n        isBack,\n      });\n    }\n\n    // Закончилась анимация свайпа назад\n    if (prevProps.activePanel !== this.props.activePanel && prevState.swipingBack) {\n      const nextPanel = this.props.activePanel;\n      const prevPanel = prevProps.activePanel;\n      this.setState({\n        swipeBackPrevPanel: null,\n        swipeBackNextPanel: null,\n        swipingBack: false,\n        swipeBackResult: null,\n        swipebackStartX: 0,\n        swipeBackShift: 0,\n        activePanel: nextPanel,\n        visiblePanels: [nextPanel],\n        scrolls: removeObjectKeys(prevState.scrolls, [prevState.swipeBackPrevPanel]),\n      }, () => {\n        this.document.dispatchEvent(createCustomEvent(this.window, transitionEndEventName));\n        this.props.scroll.scrollTo(0, prevState.scrolls[this.state.activePanel]);\n        prevProps.onTransition && prevProps.onTransition({ isBack: true, from: prevPanel, to: nextPanel });\n      });\n    }\n\n    const scrolls = this.state.scrolls;\n\n    // Начался переход\n    if (!prevState.animated && this.state.animated) {\n      const transitionStartEventData = {\n        detail: {\n          from: this.state.prevPanel,\n          to: this.state.nextPanel,\n          isBack: this.state.isBack,\n          scrolls,\n        },\n      };\n      this.document.dispatchEvent(new (this.window as any).CustomEvent(transitionStartEventName, transitionStartEventData));\n      const nextPanelElement = this.pickPanel(this.state.nextPanel);\n      const prevPanelElement = this.pickPanel(this.state.prevPanel);\n\n      prevPanelElement.scrollTop = scrolls[this.state.prevPanel];\n      if (this.state.isBack) {\n        nextPanelElement.scrollTop = scrolls[this.state.nextPanel];\n      }\n      this.waitAnimationFinish(this.pickPanel(this.state.isBack ? this.state.prevPanel : this.state.nextPanel), this.transitionEndHandler);\n    }\n\n    // Начался свайп назад\n    if (!prevState.swipingBack && this.state.swipingBack) {\n      const transitionStartEventData = {\n        detail: {\n          from: this.state.swipeBackPrevPanel,\n          to: this.state.swipeBackNextPanel,\n          scrolls,\n        },\n      };\n      this.document.dispatchEvent(new (this.window as any).CustomEvent(transitionStartEventName, transitionStartEventData));\n      this.props.onSwipeBackStart && this.props.onSwipeBackStart();\n      const nextPanelElement = this.pickPanel(this.state.swipeBackNextPanel);\n      const prevPanelElement = this.pickPanel(this.state.swipeBackPrevPanel);\n\n      nextPanelElement.scrollTop = scrolls[this.state.swipeBackNextPanel];\n      prevPanelElement.scrollTop = scrolls[this.state.swipeBackPrevPanel];\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n      this.waitTransitionFinish(this.pickPanel(this.state.swipeBackNextPanel), this.swipingBackTransitionEndHandler);\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (prevState.swipeBackResult === SwipeBackResults.fail && !this.state.swipeBackResult) {\n      this.props.scroll.scrollTo(0, scrolls[this.state.activePanel]);\n    }\n\n    // Закончился Safari свайп\n    if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel,\n      });\n    }\n  }\n\n  shouldDisableTransitionMotion(): boolean {\n    return this.props.configProvider.transitionMotionEnabled === false ||\n      !this.props.splitCol.animate;\n  }\n\n  waitTransitionFinish(elem: HTMLElement, eventHandler: TransitionEventHandler): void {\n    if (transitionEvent.supported) {\n      elem.removeEventListener(transitionEvent.name, eventHandler);\n      elem.addEventListener(transitionEvent.name, eventHandler);\n    } else {\n      clearTimeout(this.transitionFinishTimeout);\n      this.transitionFinishTimeout = setTimeout(eventHandler, this.props.platform === ANDROID || this.props.platform === VKCOM ? 300 : 600);\n    }\n  }\n\n  waitAnimationFinish(elem: HTMLElement, eventHandler: AnimationEventHandler): void {\n    if (this.shouldDisableTransitionMotion()) {\n      eventHandler();\n      return;\n    }\n\n    if (animationEvent.supported) {\n      elem.removeEventListener(animationEvent.name, eventHandler);\n      elem.addEventListener(animationEvent.name, eventHandler);\n    } else {\n      clearTimeout(this.animationFinishTimeout);\n      this.animationFinishTimeout = setTimeout(eventHandler, this.props.platform === ANDROID || this.props.platform === VKCOM ? 300 : 600);\n    }\n  }\n\n  blurActiveElement(): void {\n    if (typeof this.window !== 'undefined' && this.document.activeElement) {\n      (this.document.activeElement as HTMLElement).blur();\n    }\n  }\n\n  pickPanel(id: string) {\n    return this.panelNodes[id];\n  }\n\n  transitionEndHandler = (e?: AnimationEvent): void => {\n    if (!e || [\n      'vkui-animation-ios-next-forward',\n      'vkui-animation-ios-prev-back',\n      'vkui-animation-view-next-forward',\n      'vkui-animation-view-prev-back',\n    ].includes(e.animationName)) {\n      const activePanel = this.props.activePanel;\n      const isBack = this.state.isBack;\n      const prevPanel = this.state.prevPanel;\n      this.document.dispatchEvent(createCustomEvent(this.window, transitionEndEventName));\n      this.setState({\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel: activePanel,\n        animated: false,\n        isBack: undefined,\n        scrolls: isBack ? removeObjectKeys(this.state.scrolls, [prevPanel]) : this.state.scrolls,\n      }, () => {\n        isBack && this.props.scroll.scrollTo(0, this.state.scrolls[activePanel]);\n        this.props.onTransition && this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      });\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e?: TransitionEvent): void => {\n    // indexOf because of vendor prefixes in old browsers\n    const target = e.target as HTMLElement;\n    if (e.propertyName.includes('transform') && target === this.pickPanel(this.state.swipeBackNextPanel)) {\n      switch (this.state.swipeBackResult) {\n        case SwipeBackResults.fail:\n          this.onSwipeBackCancel();\n          break;\n        case SwipeBackResults.success:\n          this.onSwipeBackSuccess();\n      }\n    }\n  };\n\n  onSwipeBackSuccess(): void {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel(): void {\n    this.props.onSwipeBackCancel && this.props.onSwipeBackCancel();\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipeBackResult: null,\n      swipebackStartX: 0,\n      swipeBackShift: 0,\n    }, () => {\n      this.document.dispatchEvent(createCustomEvent(this.window, transitionEndEventName));\n    });\n  }\n\n  onMoveX = (e: TouchEvent): void => {\n    const target = e.originalEvent.target as HTMLElement;\n    if (\n      target &&\n      typeof target.tagName === 'string' &&\n      swipeBackExcludedTags.includes(target.tagName.toLowerCase())\n    ) {\n      return;\n    }\n\n    const { platform, configProvider } = this.props;\n\n    if (platform === IOS && !configProvider.isWebView && (e.startX <= 70 || e.startX >= this.window.innerWidth - 70) && !this.state.browserSwipe) {\n      this.setState({ browserSwipe: true });\n    }\n\n    if (platform === IOS && configProvider.isWebView && this.props.onSwipeBack) {\n      if (this.state.animated && e.startX <= 70) {\n        return;\n      }\n\n      if (e.startX <= 70 && !this.state.swipingBack && this.props.history.length > 1) {\n        this.setState({\n          swipingBack: true,\n          swipebackStartX: e.startX,\n          startT: e.startT,\n          swipeBackPrevPanel: this.state.activePanel,\n          swipeBackNextPanel: this.props.history.slice(-2)[0],\n          scrolls: {\n            ...this.state.scrolls,\n            [this.state.activePanel]: this.props.scroll.getScroll().y,\n          },\n        });\n      }\n      if (this.state.swipingBack) {\n        let swipeBackShift;\n        if (e.shiftX < 0) {\n          swipeBackShift = 0;\n        } else if (e.shiftX > this.window.innerWidth - this.state.swipebackStartX) {\n          swipeBackShift = this.window.innerWidth;\n        } else {\n          swipeBackShift = e.shiftX;\n        }\n        this.setState({ swipeBackShift });\n      }\n    }\n  };\n\n  onEnd = (): void => {\n    if (this.state.swipingBack) {\n      const speed = this.state.swipeBackShift / (Date.now() - this.state.startT.getTime()) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= this.window.innerWidth) {\n        this.onSwipeBackSuccess();\n      } else if (speed > 250 || this.state.swipebackStartX + this.state.swipeBackShift > this.window.innerWidth / 2) {\n        this.setState({ swipeBackResult: SwipeBackResults.success });\n      } else {\n        this.setState({ swipeBackResult: SwipeBackResults.fail });\n      }\n    }\n  };\n\n  calcPanelSwipeStyles(panelId: string): CSSProperties {\n    if (!canUseDOM) {\n      return {};\n    }\n\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if (!isPrev && !isNext || this.state.swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${-50 + this.state.swipeBackShift * 100 / this.window.innerWidth / 2}%`;\n    let prevPanelShadow = 0.3 * (this.window.innerWidth - this.state.swipeBackShift) / this.window.innerWidth;\n\n    if (this.state.swipeBackResult) {\n      return isPrev ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` } : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`,\n      };\n    }\n\n    return {};\n  }\n\n  render() {\n    const {\n      popout, modal, platform,\n      activePanel: _1, splitCol, configProvider, history, id, nav,\n      onTransition, onSwipeBack, onSwipeBackStart, onSwipeBackCancel,\n      window, document, scroll,\n      ...restProps\n    } = this.props;\n    const { prevPanel, nextPanel, activePanel, swipeBackPrevPanel, swipeBackNextPanel, swipeBackResult } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels.filter((panel: React.ReactElement) => {\n      const panelId = getNavId(panel.props, warn);\n\n      return this.state.visiblePanels.includes(panelId) ||\n        panelId === swipeBackPrevPanel ||\n        panelId === swipeBackNextPanel;\n    });\n\n    const disableAnimation = this.shouldDisableTransitionMotion();\n\n    const modifiers = {\n      'View--animated': !disableAnimation && this.state.animated,\n      'View--swiping-back': !disableAnimation && this.state.swipingBack,\n      'View--no-motion': disableAnimation,\n    };\n\n    return (\n      <Touch\n        Component=\"section\"\n        {...restProps}\n        vkuiClass={classNames(getClassName('View', platform), modifiers)}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        <div vkuiClass=\"View__panels\">\n          {panels.map((panel: React.ReactElement) => {\n            const panelId = getNavId(panel.props, warn);\n\n            return (\n              <div\n                vkuiClass={classNames('View__panel', {\n                  'View__panel--active': panelId === activePanel,\n                  'View__panel--prev': panelId === prevPanel,\n                  'View__panel--next': panelId === nextPanel,\n                  'View__panel--swipe-back-prev': panelId === swipeBackPrevPanel,\n                  'View__panel--swipe-back-next': panelId === swipeBackNextPanel,\n                  'View__panel--swipe-back-success': swipeBackResult === SwipeBackResults.success,\n                  'View__panel--swipe-back-failed': swipeBackResult === SwipeBackResults.fail,\n                })}\n                ref={(el) => this.panelNodes[panelId] = el}\n                data-vkui-active-panel={panelId === activePanel ? 'true' : ''}\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div vkuiClass=\"View__panel-in\">\n                  {panel}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        <AppRootPortal>\n          {hasPopout && <div vkuiClass=\"View__popout\">{popout}</div>}\n          {hasModal && <div vkuiClass=\"View__modal\">{modal}</div>}\n        </AppRootPortal>\n      </Touch>\n    );\n  }\n}\n\nexport default withContext(withContext(\n  withContext(\n    withPlatform(withDOM<ViewProps>(View)),\n    SplitColContext, 'splitCol'),\n  ConfigProviderContext, 'configProvider'),\nScrollContext, 'scroll');\n"],"file":"View.js"}