{"version":3,"sources":["../../../../src/components/ModalRoot/ModalRootContext.tsx"],"names":["ModalRootContext","updateModalHeight","undefined","registerModal","isInsideModal","useModalRegistry","id","type","modalContext","elements","current","reset","Object","keys","reduce","acc","k","refs","modalElement","e","innerElement","headerElement","contentElement","footerElement"],"mappings":";;;;;;;;;;;;;;AAAA;;AACA;;AAaO,IAAMA,gBAAgB,gBAAG,0BAAyC;AACvEC,EAAAA,iBAAiB,EAAE;AAAA,WAAMC,SAAN;AAAA,GADoD;AAEvEC,EAAAA,aAAa,EAAE;AAAA,WAAMD,SAAN;AAAA,GAFwD;AAGvEE,EAAAA,aAAa,EAAE;AAHwD,CAAzC,CAAzB;AAMP;;;;;;AAGO,SAASC,gBAAT,CAA0BC,EAA1B,EAAsCC,IAAtC,EAAuD;AAC5D,MAAMC,YAAY,GAAG,uBAAWR,gBAAX,CAArB;AACA,MAAMS,QAAQ,GAAG,mBAAsB,EAAtB,EAA0BC,OAA3C;AACA,4DAA0B,YAAM;AAC9BF,IAAAA,YAAY,CAACL,aAAb,6DAAgCM,QAAhC;AAA0CF,MAAAA,IAAI,EAAJA,IAA1C;AAAgDD,MAAAA,EAAE,EAAFA;AAAhD,QAD8B,CAE9B;;AACA,QAAMK,KAAK,GAAGC,MAAM,CAACC,IAAP,CAAYJ,QAAZ,EAAsBK,MAAtB,CACZ,UAACC,GAAD,EAAMC,CAAN;AAAA,yEAAuCD,GAAvC,yCAA6CC,CAA7C,EAAiD,IAAjD;AAAA,KADY,EAEZ;AAAET,MAAAA,IAAI,EAAJA,IAAF;AAAQD,MAAAA,EAAE,EAAFA;AAAR,KAFY,CAAd;AAGA,WAAO;AAAA,aAAME,YAAY,CAACL,aAAb,CAA2BQ,KAA3B,CAAN;AAAA,KAAP;AACD,GAPD,EAOG,EAPH;AASA,MAAMM,IAAI,GAAG,mBAA4B;AACvCC,IAAAA,YAAY,EAAE,sBAACC,CAAD;AAAA,aAAOV,QAAQ,CAACS,YAAT,GAAwBC,CAA/B;AAAA,KADyB;AAEvCC,IAAAA,YAAY,EAAE,sBAACD,CAAD;AAAA,aAAOV,QAAQ,CAACW,YAAT,GAAwBD,CAA/B;AAAA,KAFyB;AAGvCE,IAAAA,aAAa,EAAE,uBAACF,CAAD;AAAA,aAAOV,QAAQ,CAACY,aAAT,GAAyBF,CAAhC;AAAA,KAHwB;AAIvCG,IAAAA,cAAc,EAAE,wBAACH,CAAD;AAAA,aAAOV,QAAQ,CAACa,cAAT,GAA0BH,CAAjC;AAAA,KAJuB;AAKvCI,IAAAA,aAAa,EAAE,uBAACJ,CAAD;AAAA,aAAOV,QAAQ,CAACc,aAAT,GAAyBJ,CAAhC;AAAA;AALwB,GAA5B,EAMVT,OANH;AAOA,SAAO;AAAEO,IAAAA,IAAI,EAAJA;AAAF,GAAP;AACD;;eAEcjB,gB","sourcesContent":["import { createContext, useContext, useRef } from 'react';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { ModalElements, ModalsStateEntry, ModalType } from './types';\n\nexport type ModalRegistryEntry = ModalElements & Required<Pick<ModalsStateEntry, 'type' | 'id'>>;\ntype ModalRefs = { [k in keyof ModalElements]: (e: ModalElements[k]) => void };\n\nexport interface ModalRootContextInterface {\n  updateModalHeight: VoidFunction;\n  registerModal(data: ModalRegistryEntry): void;\n  onClose?: VoidFunction;\n  isInsideModal: boolean;\n}\n\nexport const ModalRootContext = createContext<ModalRootContextInterface>({\n  updateModalHeight: () => undefined,\n  registerModal: () => undefined,\n  isInsideModal: false,\n});\n\n/**\n * All referenced elements must be static\n */\nexport function useModalRegistry(id: string, type: ModalType) {\n  const modalContext = useContext(ModalRootContext);\n  const elements = useRef<ModalElements>({}).current;\n  useIsomorphicLayoutEffect(() => {\n    modalContext.registerModal({ ...elements, type, id });\n    // unset refs on  unmount to prevent leak\n    const reset = Object.keys(elements).reduce<ModalRegistryEntry>(\n      (acc, k: keyof ModalElements) => ({ ...acc, [k]: null }),\n      { type, id });\n    return () => modalContext.registerModal(reset);\n  }, []);\n\n  const refs = useRef<Required<ModalRefs>>({\n    modalElement: (e) => elements.modalElement = e,\n    innerElement: (e) => elements.innerElement = e,\n    headerElement: (e) => elements.headerElement = e,\n    contentElement: (e) => elements.contentElement = e,\n    footerElement: (e) => elements.footerElement = e,\n  }).current;\n  return { refs };\n}\n\nexport default ModalRootContext;\n"],"file":"ModalRootContext.js"}