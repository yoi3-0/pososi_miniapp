{"version":3,"sources":["../../../../src/components/Gallery/Gallery.tsx"],"names":["BaseGallery","props","e","setState","animation","startT","isDraggable","isFullyVisible","originalEvent","preventDefault","isSlideX","onDragStart","state","deltaX","shiftX","dragging","targetIndex","isSlide","getTarget","slideIndex","onDragEnd","onChange","onEnd","initializeSlides","canSlideLeft","canSlideRight","id","slide","slidesStore","viewport","getRef","container","getRootRef","containerWidth","slides","duration","options","React","Children","map","children","_item","i","elem","coordX","offsetLeft","width","offsetWidth","layerWidth","reduce","val","min","calcMin","max","calcMax","calculateIndent","isValidShift","validateIndent","window","requestAnimationFrame","viewportWidth","align","isCenterWithCustomWidth","length","targetSlide","indent","Number","value","expectDeltaX","Date","now","getTime","shift","direction","item","index","previousValue","Math","abs","currentValue","addEventListener","onResize","prevProps","widthChanged","slideWidth","isPropUpdate","slideCountChanged","count","isCustomWidth","removeEventListener","bullets","platform","hasMouse","showArrows","document","restProps","calculateDragIndent","layerStyle","WebkitTransform","transform","WebkitTransition","transition","onStart","onMoveX","getViewportRef","getSlideRef","slideLeft","slideRight","Component","BaseGalleryAdaptive","Gallery","initialSlideIndex","timeout","localSlideIndex","setSlideIndex","isControlled","Boolean","toArray","filter","childCount","handleChange","current","autoplay","set","clear","safeSlideIndex"],"mappings":"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","sourcesContent":["import React, { Children, Component, HTMLAttributes, ReactElement, RefCallback, useCallback, useEffect, useState, FC } from 'react';\nimport { getClassName } from '../../helpers/getClassName';\nimport Touch, { TouchEventHandler, TouchEvent } from '../Touch/Touch';\nimport { classNames } from '../../lib/classNames';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport { HasAlign, HasPlatform, HasRef, HasRootRef } from '../../types';\nimport { withDOM, DOMProps } from '../../lib/dom';\nimport { setRef } from '../../lib/utils';\nimport { withAdaptivity, AdaptivityProps } from '../../hoc/withAdaptivity';\nimport HorizontalScrollArrow from '../HorizontalScroll/HorizontalScrollArrow';\nimport { clamp } from '../../helpers/math';\nimport { useTimeout } from '../../hooks/useTimeout';\n\nexport interface BaseGalleryProps extends\n  Omit<HTMLAttributes<HTMLDivElement>, 'onChange' | 'onDragStart' | 'onDragEnd'>,\n  HasPlatform,\n  HasAlign,\n  HasRootRef<HTMLDivElement>,\n  HasRef<HTMLElement> {\n  slideWidth?: string | number;\n  slideIndex?: number;\n  onDragStart?: TouchEventHandler;\n  onDragEnd?: TouchEventHandler;\n  onChange?(current: number): void;\n  onEnd?({ targetIndex }: { targetIndex: number }): void;\n  bullets?: 'dark' | 'light' | false;\n  isDraggable?: boolean;\n  showArrows?: boolean;\n}\n\nexport interface GalleryProps extends BaseGalleryProps {\n  initialSlideIndex?: number;\n  timeout?: number;\n}\n\nexport interface GalleryState {\n  containerWidth: number;\n  layerWidth?: number;\n  min?: number;\n  max?: number;\n  startT?: Date;\n  deltaX: number;\n  shiftX: number;\n  slides: GallerySlidesState[];\n  animation: boolean;\n  duration: number;\n  dragging?: boolean;\n}\n\nexport interface GallerySlidesState {\n  coordX: number;\n  width: number;\n}\n\ntype GetSlideRef = (index: number) => RefCallback<HTMLElement>;\n\nclass BaseGallery extends Component<BaseGalleryProps & DOMProps & AdaptivityProps, GalleryState> {\n  constructor(props: GalleryProps) {\n    super(props);\n\n    this.state = {\n      containerWidth: 0,\n      deltaX: 0,\n      shiftX: 0,\n      slides: [],\n      animation: true,\n      duration: 0.24,\n    };\n\n    this.slidesStore = {};\n  }\n\n  container: HTMLDivElement;\n  slidesStore: {\n    [index: string]: HTMLElement;\n  };\n  viewport: HTMLElement;\n\n  static defaultProps: Partial<BaseGalleryProps> = {\n    slideWidth: '100%',\n    children: '',\n    align: 'left',\n    bullets: false,\n    isDraggable: true,\n  };\n\n  get isCenterWithCustomWidth() {\n    return this.props.slideWidth === 'custom' && this.props.align === 'center';\n  }\n\n  initializeSlides(options: { animation?: boolean } = {}) {\n    const slides: GallerySlidesState[] = React.Children.map(\n      this.props.children,\n      (_item: ReactElement, i: number): GallerySlidesState => {\n        const elem = this.slidesStore[`slide-${i}`];\n        return {\n          coordX: elem.offsetLeft,\n          width: elem.offsetWidth,\n        };\n      });\n\n    const containerWidth = this.container.offsetWidth;\n    const layerWidth = slides.reduce((val: number, slide: GallerySlidesState) => slide.width + val, 0);\n\n    const min = this.calcMin({ containerWidth, layerWidth, slides });\n    const max = this.calcMax({ slides });\n\n    this.setState({ min, max, layerWidth, containerWidth, slides }, () => {\n      const shiftX = this.calculateIndent(this.props.slideIndex);\n      if (this.state.shiftX === shiftX) {\n        return;\n      }\n      const isValidShift = this.state.shiftX === this.validateIndent(this.state.shiftX);\n      const { animation = isValidShift } = options;\n      this.setState({ shiftX, animation }, () => {\n        if (!this.state.animation) {\n          this.props.window.requestAnimationFrame(() => this.setState({ animation: true }));\n        }\n      });\n    });\n  }\n\n  calcMin({ containerWidth, layerWidth, slides }: Pick<GalleryState, 'containerWidth' | 'layerWidth' | 'slides'>) {\n    const viewportWidth = this.viewport.offsetWidth;\n    switch (this.props.align) {\n      case 'left':\n        return containerWidth - layerWidth;\n      case 'right':\n        return viewportWidth - layerWidth;\n      case 'center':\n        if (this.isCenterWithCustomWidth && slides.length) {\n          const { coordX, width } = slides[slides.length - 1];\n          return viewportWidth / 2 - coordX - width / 2;\n        } else {\n          return viewportWidth - (containerWidth - viewportWidth) / 2 - layerWidth;\n        }\n    }\n  }\n\n  calcMax({ slides }: Pick<GalleryState, 'slides'>) {\n    const viewportWidth = this.viewport.offsetWidth;\n    if (this.isCenterWithCustomWidth && slides.length) {\n      const { width, coordX } = slides[0];\n      return viewportWidth / 2 - coordX - width / 2;\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n   * Считает отступ слоя галереи\n   */\n  calculateIndent(targetIndex: number) {\n    const { slides } = this.state;\n\n    if (this.isFullyVisible) {\n      return 0;\n    }\n\n    const targetSlide = slides.length ? slides[targetIndex] : null;\n\n    if (targetSlide) {\n      const { coordX, width } = targetSlide;\n\n      if (this.isCenterWithCustomWidth) {\n        const viewportWidth = this.viewport.offsetWidth;\n        return viewportWidth / 2 - coordX - width / 2;\n      }\n\n      return this.validateIndent(-1 * coordX);\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n   * Считает отступ слоя галереи во время драга\n   */\n  calculateDragIndent() {\n    const { shiftX, deltaX, min, max } = this.state;\n    const indent = shiftX + deltaX;\n\n    if (indent > max) {\n      return max + Number((indent - max) / 3);\n    } else if (indent < min) {\n      return min + Number((indent - min) / 3);\n    }\n\n    return indent;\n  }\n\n  validateIndent(value: number) {\n    const { min, max } = this.state;\n\n    if (value < min) {\n      return min;\n    } else if (value > max) {\n      return max;\n    }\n\n    return value;\n  }\n\n  get isFullyVisible() {\n    return this.state.layerWidth <= this.state.containerWidth;\n  }\n\n  /*\n   * Получает индекс слайда, к которому будет осуществлен переход\n   */\n  getTarget() {\n    const { slides, deltaX, shiftX, startT, max } = this.state;\n    const { slideIndex } = this.props;\n    const expectDeltaX = deltaX / (Date.now() - startT.getTime()) * 240 * 0.6;\n    const shift = shiftX + deltaX + expectDeltaX - max;\n    const direction = deltaX < 0 ? 1 : -1;\n\n    // Находим ближайшую границу слайда к текущему отступу\n    let targetIndex = slides.reduce((val: number, item: GallerySlidesState, index: number) => {\n      const previousValue = Math.abs(slides[val].coordX + shift);\n      const currentValue = Math.abs(item.coordX + shift);\n\n      return previousValue < currentValue ? val : index;\n    }, slideIndex);\n\n    if (targetIndex === slideIndex) {\n      let targetSlide = slideIndex + direction;\n\n      if (targetSlide >= 0 && targetSlide < slides.length) {\n        if (Math.abs(deltaX) > slides[targetSlide].width * 0.05) {\n          targetIndex = targetSlide;\n        }\n      }\n    }\n\n    return targetIndex;\n  }\n\n  onStart: TouchEventHandler = (e: TouchEvent) => {\n    this.setState({\n      animation: false,\n      startT: e.startT,\n    });\n  };\n\n  onMoveX: TouchEventHandler = (e: TouchEvent) => {\n    if (this.props.isDraggable && !this.isFullyVisible) {\n      e.originalEvent.preventDefault();\n\n      if (e.isSlideX) {\n        this.props.onDragStart && this.props.onDragStart(e);\n\n        if (this.state.deltaX !== e.shiftX || this.state.dragging !== e.isSlideX) {\n          this.setState({\n            deltaX: e.shiftX,\n            dragging: e.isSlideX,\n          });\n        }\n      }\n    }\n  };\n\n  onEnd: TouchEventHandler = (e: TouchEvent) => {\n    const targetIndex = e.isSlide ? this.getTarget() : this.props.slideIndex;\n    this.props.onDragEnd && this.props.onDragEnd(e);\n    this.setState({ deltaX: 0, animation: true }, () => this.props.onChange(targetIndex));\n\n    if (this.props.onEnd) {\n      this.props.onEnd({ targetIndex });\n    }\n  };\n\n  onResize: VoidFunction = () => this.initializeSlides({ animation: false });\n\n  get canSlideLeft() {\n    // shiftX is negative number <= 0, we can swipe back only if it is < 0\n    return !this.isFullyVisible && this.state.shiftX < 0;\n  }\n\n  get canSlideRight() {\n    const { containerWidth, layerWidth, shiftX, slides } = this.state;\n    const { align, slideIndex } = this.props;\n    return !this.isFullyVisible && (\n      // we can't move right when gallery layer fully scrolled right, if gallery aligned by left side\n      align === 'left' && containerWidth - shiftX < layerWidth ||\n      // otherwise we need to check current slide index (align = right or align = center)\n      align !== 'left' && slideIndex < slides.length - 1\n    );\n  }\n\n  slideLeft = () => {\n    const { slideIndex, onChange } = this.props;\n    if (this.canSlideLeft) {\n      this.setState({ deltaX: 0, animation: true }, () => onChange(slideIndex - 1));\n    }\n  };\n\n  slideRight = () => {\n    const { slideIndex, onChange } = this.props;\n    if (this.canSlideRight) {\n      this.setState({ deltaX: 0, animation: true }, () => onChange(slideIndex + 1));\n    }\n  };\n\n  getSlideRef: GetSlideRef = (id: number) => (slide) => {\n    this.slidesStore[`slide-${id}`] = slide;\n  };\n\n  getViewportRef: RefCallback<HTMLElement> = (viewport) => {\n    this.viewport = viewport;\n    setRef(viewport, this.props.getRef);\n  };\n\n  getRootRef: RefCallback<HTMLDivElement> = (container) => {\n    this.container = container;\n    setRef(container, this.props.getRootRef);\n  };\n\n  componentDidMount() {\n    this.initializeSlides({ animation: false });\n    this.props.window.addEventListener('resize', this.onResize);\n  }\n\n  componentDidUpdate(prevProps: GalleryProps) {\n    const widthChanged = this.props.slideWidth !== prevProps.slideWidth;\n    const isPropUpdate = this.props !== prevProps;\n    const slideCountChanged = Children.count(this.props.children) !== Children.count(prevProps.children);\n    const isCustomWidth = this.props.slideWidth === 'custom';\n\n    // в любом из этих случаев позиция могла поменяться\n    if (widthChanged || slideCountChanged || isCustomWidth && isPropUpdate) {\n      this.initializeSlides();\n    } else if (this.props.slideIndex !== prevProps.slideIndex) {\n      this.setState({\n        animation: true,\n        deltaX: 0,\n        shiftX: this.calculateIndent(this.props.slideIndex),\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.window.removeEventListener('resize', this.onResize);\n  }\n\n  render() {\n    const { animation, duration, dragging } = this.state;\n    const {\n      children,\n      slideWidth,\n      slideIndex,\n      isDraggable,\n      onDragStart,\n      onDragEnd,\n      onChange,\n      onEnd,\n      align,\n      bullets,\n      platform,\n      hasMouse,\n      showArrows,\n      window,\n      document,\n      getRef,\n      getRootRef,\n      ...restProps\n    } = this.props;\n\n    const indent = dragging ? this.calculateDragIndent() : this.calculateIndent(slideIndex);\n\n    const layerStyle = {\n      WebkitTransform: `translateX(${indent}px)`,\n      transform: `translateX(${indent}px)`,\n      WebkitTransition: animation ? `-webkit-transform ${duration}s cubic-bezier(.1, 0, .25, 1)` : 'none',\n      transition: animation ? `transform ${duration}s cubic-bezier(.1, 0, .25, 1)` : 'none',\n    };\n\n    return (\n      <div\n        {...restProps}\n        vkuiClass={classNames(getClassName('Gallery', platform), `Gallery--${align}`, {\n          'Gallery--dragging': dragging,\n          'Gallery--custom-width': slideWidth === 'custom',\n        })}\n        ref={this.getRootRef}\n      >\n        <Touch\n          vkuiClass=\"Gallery__viewport\"\n          onStartX={this.onStart}\n          onMoveX={this.onMoveX}\n          onEnd={this.onEnd}\n          noSlideClick\n          style={{ width: slideWidth === 'custom' ? '100%' : slideWidth }}\n          getRootRef={this.getViewportRef}\n        >\n          <div vkuiClass=\"Gallery__layer\" style={layerStyle}>\n            {React.Children.map(children, (item: ReactElement, i: number) =>\n              <div vkuiClass=\"Gallery__slide\" key={`slide-${i}`} ref={this.getSlideRef(i)}>{item}</div>,\n            )}\n          </div>\n        </Touch>\n\n        {bullets &&\n        <div aria-hidden=\"true\" vkuiClass={classNames('Gallery__bullets', `Gallery__bullets--${bullets}`)}>\n          {React.Children.map(children, (_item: ReactElement, index: number) =>\n            <div\n              vkuiClass={classNames('Gallery__bullet', { 'Gallery__bullet--active': index === slideIndex })}\n              key={index}\n            />,\n          )}\n        </div>\n        }\n\n        {showArrows && hasMouse && this.canSlideLeft && <HorizontalScrollArrow direction=\"left\" onClick={this.slideLeft} />}\n        {showArrows && hasMouse && this.canSlideRight && <HorizontalScrollArrow direction=\"right\" onClick={this.slideRight} />}\n      </div>\n    );\n  }\n}\n\nconst BaseGalleryAdaptive = withAdaptivity(withDOM<BaseGalleryProps>(BaseGallery), {\n  hasMouse: true,\n});\n\nconst Gallery: FC<GalleryProps> = ({\n  initialSlideIndex = 0,\n  children,\n  timeout,\n  onChange,\n  ...props\n}: GalleryProps) => {\n  const [localSlideIndex, setSlideIndex] = useState(initialSlideIndex);\n  const isControlled = typeof props.slideIndex === 'number';\n  const slideIndex = isControlled ? props.slideIndex : localSlideIndex;\n  const isDraggable = !isControlled || Boolean(onChange);\n  const slides = React.Children.toArray(children).filter((item) => Boolean(item));\n  const childCount = slides.length;\n\n  const handleChange: GalleryProps['onChange'] = useCallback((current) => {\n    if (current === slideIndex) {\n      return;\n    }\n    !isControlled && setSlideIndex(current);\n    onChange && onChange(current);\n  }, [onChange, slideIndex]);\n\n  const autoplay = useTimeout(() => handleChange((slideIndex + 1) % childCount), timeout);\n  useEffect(() => timeout ? autoplay.set() : autoplay.clear(), [timeout, slideIndex]);\n\n  // prevent invalid slideIndex\n  // any slide index is invalid with no slides, just keep it as is\n  const safeSlideIndex = childCount > 0 ? clamp(slideIndex, 0, childCount - 1) : slideIndex;\n  // notify parent in controlled mode\n  useEffect(() => {\n    if (onChange && safeSlideIndex !== slideIndex) {\n      onChange(safeSlideIndex);\n    }\n  }, [safeSlideIndex]);\n\n  return (\n    <BaseGalleryAdaptive\n      isDraggable={isDraggable}\n      {...props}\n      slideIndex={safeSlideIndex}\n      onChange={handleChange}\n    >{slides}</BaseGalleryAdaptive>\n  );\n};\n\nexport default withPlatform(Gallery);\n"],"file":"Gallery.js"}