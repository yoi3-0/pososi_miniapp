{"version":3,"sources":["../../../src/components/ActionSheet/ActionSheetDropdownDesktop.tsx"],"names":["Component","getClassName","classNames","withPlatform","withAdaptivity","withDOM","ActionSheetDropdownDesktop","dropdownStyles","left","top","opacity","pointerEvents","props","toggleRef","elementRef","popupDirection","toggleRect","getBoundingClientRect","elementRect","current","width","window","pageXOffset","height","pageYOffset","setState","setTimeout","addEventListener","handleClickOutside","removeEventListener","e","dropdownElement","target","contains","onClose","stopPropagation","children","platform","closing","sizeY","document","restProps","baseClaseName","state"],"mappings":"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","sourcesContent":["import { Component, CSSProperties, HTMLAttributes, MouseEventHandler, RefObject } from 'react';\nimport { getClassName } from '../../helpers/getClassName';\nimport { classNames } from '../../lib/classNames';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport { HasPlatform } from '../../types';\nimport { withAdaptivity, AdaptivityProps } from '../../hoc/withAdaptivity';\nimport { DOMProps, withDOM } from '../../lib/dom';\nimport { ActionSheetProps } from './ActionSheet';\n\ninterface Props extends HTMLAttributes<HTMLDivElement>, HasPlatform, AdaptivityProps {\n  closing: boolean;\n  onClose(): void;\n  popupDirection?: ActionSheetProps['popupDirection'];\n  toggleRef: Element;\n  elementRef: RefObject<HTMLDivElement>;\n}\n\ninterface State {\n  dropdownStyles: CSSProperties;\n}\n\nclass ActionSheetDropdownDesktop extends Component<Props & DOMProps, State> {\n  state: State = {\n    dropdownStyles: {\n      left: '0',\n      top: '0',\n      opacity: '0',\n      pointerEvents: 'none',\n    },\n  };\n\n  get window(): Window {\n    return this.props.window;\n  }\n\n  componentDidMount = () => {\n    const { toggleRef, elementRef, popupDirection } = this.props;\n\n    const toggleRect = toggleRef.getBoundingClientRect();\n    const elementRect = elementRef.current.getBoundingClientRect();\n\n    let left = toggleRect.left + toggleRect.width - elementRect.width + this.window.pageXOffset;\n    let top: number;\n\n    if (popupDirection === 'top' || typeof popupDirection === 'function' && popupDirection(elementRef) === 'top') {\n      top = toggleRect.top - elementRect.height + this.window.pageYOffset;\n    } else {\n      top = toggleRect.top + toggleRect.height + this.window.pageYOffset;\n    }\n\n    this.setState({\n      dropdownStyles: {\n        left,\n        top,\n        opacity: 1,\n        pointerEvents: 'auto',\n      },\n    });\n\n    setTimeout(() => {\n      this.window.addEventListener('click', this.handleClickOutside);\n    });\n  };\n\n  componentWillUnmount = () => {\n    this.window.removeEventListener('click', this.handleClickOutside);\n  };\n\n  handleClickOutside = (e: MouseEvent) => {\n    const dropdownElement = this.props.elementRef.current;\n\n    if (dropdownElement !== e.target && dropdownElement && !dropdownElement.contains(e.target as Node)) {\n      this.onClose();\n    }\n  };\n\n  onClose = () => {\n    this.props.onClose();\n  };\n\n  stopPropagation: MouseEventHandler<HTMLDivElement> = (e) => e.stopPropagation();\n\n  render() {\n    const {\n      children,\n      platform,\n      elementRef,\n      toggleRef,\n      closing,\n      sizeY,\n      window,\n      document,\n      popupDirection,\n      ...restProps\n    } = this.props;\n    const baseClaseName = getClassName('ActionSheet', platform);\n\n    return (\n      <div\n        {...restProps}\n        ref={elementRef}\n        onClick={this.stopPropagation}\n        style={this.state.dropdownStyles}\n        vkuiClass={classNames(baseClaseName, 'ActionSheet--desktop', {\n          'ActionSheet--closing': this.props.closing,\n        }, `ActionSheet--sizeY-${sizeY}`)}\n      >\n        {children}\n      </div>\n    );\n  }\n}\n\nexport default withAdaptivity(withPlatform(withDOM<Props>(ActionSheetDropdownDesktop)), {\n  sizeY: true,\n});\n"],"file":"ActionSheetDropdownDesktop.js"}