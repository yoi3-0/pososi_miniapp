{"version":3,"sources":["../../../src/components/CardScroll/CardScroll.tsx"],"names":["useRef","classNames","getClassName","usePlatform","HorizontalScroll","withAdaptivity","useDOM","CardScroll","children","size","sizeX","restProps","platform","refContainer","gapRef","window","getScrollToLeft","offset","containerWidth","current","offsetWidth","slideIndex","Array","from","findIndex","el","offsetLeft","parseInt","getComputedStyle","marginRight","slide","scrollTo","getScrollToRight","find","defaultProps"],"mappings":"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","sourcesContent":["import { HTMLAttributes, useRef, FC } from 'react';\nimport { classNames } from '../../lib/classNames';\nimport { getClassName } from '../../helpers/getClassName';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport HorizontalScroll from '../HorizontalScroll/HorizontalScroll';\nimport { withAdaptivity, AdaptivityProps } from '../../hoc/withAdaptivity';\nimport { useDOM } from '../../lib/dom';\n\nexport interface CardScrollProps extends HTMLAttributes<HTMLDivElement>, AdaptivityProps {\n  size?: 's' | 'm' | 'l';\n}\n\nconst CardScroll: FC<CardScrollProps> = ({ children, size, sizeX, ...restProps }: CardScrollProps) => {\n  const platform = usePlatform();\n\n  const refContainer = useRef<HTMLDivElement>(null);\n  const gapRef = useRef<HTMLDivElement>(null);\n\n  const { window } = useDOM();\n\n  function getScrollToLeft(offset: number): number {\n    const containerWidth = refContainer.current.offsetWidth;\n    const slideIndex = Array\n      .from(refContainer.current.children)\n      .findIndex((el: HTMLElement) => el.offsetLeft + el.offsetWidth + parseInt(window.getComputedStyle(el).marginRight) - offset >= 0);\n\n    if (slideIndex === -1) {\n      return offset;\n    }\n\n    if (slideIndex === 0) {\n      return 0;\n    }\n\n    const slide = refContainer.current.children[slideIndex] as HTMLElement;\n\n    const scrollTo = slide.offsetLeft - (containerWidth - slide.offsetWidth) + gapRef.current.offsetWidth;\n\n    if (scrollTo <= 2 * gapRef.current.offsetWidth) {\n      return 0;\n    }\n\n    return scrollTo;\n  }\n\n  function getScrollToRight(offset: number): number {\n    const containerWidth = refContainer.current.offsetWidth;\n    const slide = Array.from(refContainer.current.children).find((el: HTMLElement) => el.offsetLeft + el.offsetWidth - offset > containerWidth) as HTMLElement;\n\n    if (!slide) {\n      return offset;\n    }\n\n    return slide.offsetLeft - gapRef.current.offsetWidth;\n  }\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\n        getClassName('CardScroll', platform),\n        `CardScroll--${size}`,\n        `CardScroll--sizeX-${sizeX}`,\n      )}\n    >\n      <HorizontalScroll getScrollToLeft={getScrollToLeft} getScrollToRight={getScrollToRight} showArrows={true}>\n        <div vkuiClass=\"CardScroll__in\" ref={refContainer}>\n          <span vkuiClass=\"CardScroll__gap\" ref={gapRef} />\n          {children}\n          <span vkuiClass=\"CardScroll__gap\" />\n        </div>\n      </HorizontalScroll>\n    </div>\n  );\n};\n\nCardScroll.defaultProps = {\n  size: 's',\n};\n\nexport default withAdaptivity(CardScroll, { sizeX: true });\n"],"file":"CardScroll.js"}