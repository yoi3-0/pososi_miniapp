{"version":3,"sources":["../../../src/components/Tappable/Tappable.tsx"],"names":["React","Component","Touch","TouchRootContext","classNames","getClassName","ANDROID","getOffsetRect","coordX","coordY","withPlatform","hasHover","setRef","withAdaptivity","shouldTriggerClickOnEnterOrSpace","ts","Date","now","ACTIVE_DELAY","ACTIVE_EFFECT_DELAY","storage","deactivateOtherInstances","exclude","Object","keys","filter","id","forEach","clearTimeout","activeTimeout","timeout","stop","TappableContext","createContext","insideTappable","Tappable","props","e","onKeyDown","preventDefault","container","click","originalEvent","insideTouchRoot","stopPropagation","state","hasActive","touches","length","platform","onDown","window","setTimeout","start","shiftXAbs","shiftYAbs","isSlide","active","activeEffectDelay","store","getStorage","top","left","x","y","key","toString","setState","clicks","wavesTimeout","hovered","getRootRef","Math","round","random","prevProps","disabled","defaultComponent","href","children","onClick","sizeX","hasMouse","propsHasHover","hoverMode","propsHasActive","activeMode","hasFocusVisible","restProps","isCustomElement","contentEditable","isPresetHoverMode","includes","isPresetActiveMode","classes","RootComponent","onStart","onMove","onEnd","getRef","ref","role","onEnter","onLeave","touchProps","undefined","map","k"],"mappings":"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","sourcesContent":["import React, {\n  AllHTMLAttributes,\n  Component,\n  ElementType,\n  KeyboardEventHandler,\n  KeyboardEvent,\n  RefCallback,\n} from 'react';\nimport Touch, { TouchEvent, TouchEventHandler, TouchProps } from '../Touch/Touch';\nimport TouchRootContext from '../Touch/TouchContext';\nimport { classNames } from '../../lib/classNames';\nimport { getClassName } from '../../helpers/getClassName';\nimport { ANDROID } from '../../lib/platform';\nimport { getOffsetRect } from '../../lib/offset';\nimport { coordX, coordY, VKUITouchEvent, VKUITouchEventHander } from '../../lib/touch';\nimport { HasPlatform, HasRootRef, Ref } from '../../types';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport { hasHover } from '@vkontakte/vkjs';\nimport { setRef } from '../../lib/utils';\nimport { withAdaptivity, AdaptivityProps } from '../../hoc/withAdaptivity';\nimport { shouldTriggerClickOnEnterOrSpace } from '../../lib/accessibility';\n\nexport interface TappableProps extends AllHTMLAttributes<HTMLElement>, HasRootRef<HTMLElement>, HasPlatform, AdaptivityProps {\n  Component?: ElementType;\n  /**\n   * Длительность показа active-состояния\n   */\n  activeEffectDelay?: number;\n  stopPropagation?: boolean;\n  /**\n   * Указывает, должен ли компонент реагировать на hover-состояние\n   */\n  hasHover?: boolean;\n  /**\n   * Указывает, должен ли компонент реагировать на active-состояние\n   */\n  hasActive?: boolean;\n  /**\n   * Стиль подсветки active-состояния. Если передать произвольную строку, она добавится как css-класс во время active\n   */\n  activeMode?: 'opacity' | 'background' | string;\n  /**\n   * Стиль подсветки hover-состояния. Если передать произвольную строку, она добавится как css-класс во время hover\n   */\n  hoverMode?: 'opacity' | 'background' | string;\n  /**\n   * @ignore Временное свойство для работы над доступностью. Указывает, должен ли компонент показывать focus ring при навигации с клавиатуры.\n   * Исчезнет после того, как мы адаптируем отображение всех компонентов на базе Tappable.\n   */\n  hasFocusVisible?: boolean;\n}\n\nexport interface TappableState {\n  clicks?: {\n    [index: string]: {\n      x: number;\n      y: number;\n    };\n  };\n  hovered?: boolean;\n  active?: boolean;\n  ts?: number;\n  hasHover?: boolean;\n  hasActive?: boolean;\n}\n\nexport interface RootComponentProps extends TouchProps {\n  ref?: Ref<HTMLElement>;\n}\n\nexport interface StorageItem {\n  activeTimeout: number;\n  timeout?: number;\n  stop(): void;\n}\n\nexport interface Storage {\n  [index: string]: StorageItem;\n}\n\nexport type GetStorage = () => StorageItem;\n\nconst ts = () => +Date.now();\n\nexport const ACTIVE_DELAY = 70;\nexport const ACTIVE_EFFECT_DELAY = 600;\n\nlet storage: Storage = {};\n\n/*\n * Очищает таймауты и хранилище для всех экземпляров компонента, кроме переданного\n */\nfunction deactivateOtherInstances(exclude?: string) {\n  Object.keys(storage).filter((id: string) => id !== exclude).forEach((id: string) => {\n    clearTimeout(storage[id].activeTimeout);\n    clearTimeout(storage[id].timeout);\n    storage[id].stop();\n\n    delete storage[id];\n  });\n}\n\nconst TappableContext = React.createContext<{ insideTappable?: boolean; onEnter?: VoidFunction; onLeave?: VoidFunction }>({ insideTappable: false });\n\nclass Tappable extends Component<TappableProps, TappableState> {\n  constructor(props: TappableProps) {\n    super(props);\n    this.id = Math.round(Math.random() * 1e8).toString(16);\n    this.state = {\n      clicks: {},\n      active: false,\n      ts: null,\n      hasHover: props.hasHover,\n      hasActive: props.hasActive,\n    };\n    this.isSlide = false;\n  }\n\n  id: string;\n\n  isSlide: boolean;\n\n  insideTouchRoot: boolean;\n\n  container: HTMLElement;\n\n  timeout: number;\n\n  wavesTimeout: number;\n\n  static defaultProps = {\n    stopPropagation: false,\n    disabled: false,\n    hasFocusVisible: false,\n    hasHover,\n    hoverMode: 'background',\n    hasActive: true,\n    activeMode: 'background',\n    activeEffectDelay: ACTIVE_EFFECT_DELAY,\n  };\n\n  /*\n   * [a11y]\n   * Обрабатывает событие onkeydown\n   * для кастомных доступных элементов:\n   * - role=\"link\" (активация по Enter)\n   * - role=\"button\" (активация по Space и Enter)\n   */\n  onKeyDown: KeyboardEventHandler = (e: KeyboardEvent<HTMLElement>) => {\n    const { onKeyDown } = this.props;\n\n    if (shouldTriggerClickOnEnterOrSpace(e)) {\n      e.preventDefault();\n      this.container.click();\n    }\n\n    {\n      if (typeof onKeyDown === 'function') {\n        return onKeyDown(e);\n      }\n    }\n  };\n\n  /*\n   * Обрабатывает событие touchstart\n   */\n  onStart: TouchEventHandler = ({ originalEvent }: TouchEvent) => {\n    !this.insideTouchRoot && this.props.stopPropagation && originalEvent.stopPropagation();\n\n    if (this.state.hasActive) {\n      if (originalEvent.touches && originalEvent.touches.length > 1) {\n        deactivateOtherInstances();\n        return;\n      }\n\n      if (this.props.platform === ANDROID) {\n        this.onDown(originalEvent);\n      }\n\n      storage[this.id] = {\n        stop: this.stop,\n        activeTimeout: window.setTimeout(this.start, ACTIVE_DELAY),\n      };\n    }\n  };\n\n  /*\n   * Обрабатывает событие touchmove\n   */\n  onMove: TouchEventHandler = ({ originalEvent, shiftXAbs, shiftYAbs }: TouchEvent) => {\n    !this.insideTouchRoot && this.props.stopPropagation && originalEvent.stopPropagation();\n    if (shiftXAbs > 20 || shiftYAbs > 20) {\n      this.isSlide = true;\n      this.stop();\n    }\n  };\n\n  /*\n   * Обрабатывает событие touchend\n   */\n  onEnd: TouchEventHandler = ({ originalEvent }: TouchEvent) => {\n    !this.insideTouchRoot && this.props.stopPropagation && originalEvent.stopPropagation();\n    const now = ts();\n\n    if (originalEvent.touches && originalEvent.touches.length > 0) {\n      this.isSlide = false;\n      this.stop();\n      return;\n    }\n\n    if (this.state.active) {\n      if (now - this.state.ts >= 100) {\n        // Долгий тап, выключаем подсветку\n        this.stop();\n      } else {\n        // Короткий тап, оставляем подсветку\n        const timeout = window.setTimeout(this.stop, this.props.activeEffectDelay - now + this.state.ts);\n        const store = this.getStorage();\n\n        if (store) {\n          store.timeout = timeout;\n        }\n      }\n    } else if (!this.isSlide) {\n      // Очень короткий тап, включаем подсветку\n      this.start();\n\n      const timeout = window.setTimeout(this.stop, this.props.activeEffectDelay);\n\n      if (this.getStorage()) {\n        clearTimeout(this.getStorage().activeTimeout);\n        this.getStorage().timeout = timeout;\n      } else {\n        this.timeout = timeout;\n      }\n    }\n\n    this.isSlide = false;\n  };\n\n  /*\n   * Реализует эффект при тапе для Андроида\n   */\n  onDown: VKUITouchEventHander = (e: VKUITouchEvent) => {\n    if (this.props.platform === ANDROID) {\n      const { top, left } = getOffsetRect(this.container);\n      const x = coordX(e) - left;\n      const y = coordY(e) - top;\n      const key = 'wave' + Date.now().toString();\n\n      this.setState((state: TappableState): TappableState => {\n        return {\n          clicks: {\n            ...state.clicks,\n            [key]: {\n              x,\n              y,\n            },\n          },\n        };\n      });\n\n      this.wavesTimeout = window.setTimeout(() => {\n        this.setState((state: TappableState): TappableState => {\n          let clicks = { ...state.clicks };\n          delete clicks[key];\n          return { clicks };\n        });\n      }, 225);\n    }\n  };\n\n  onEnter = () => {\n    this.setState({ hovered: true });\n  };\n\n  onLeave = () => {\n    this.setState({ hovered: false });\n  };\n\n  /*\n   * Устанавливает активное выделение\n   */\n  start: VoidFunction = () => {\n    if (!this.state.active && this.state.hasActive) {\n      this.setState({\n        active: true,\n        ts: ts(),\n      });\n    }\n    deactivateOtherInstances(this.id);\n  };\n\n  /*\n   * Снимает активное выделение\n   */\n  stop: VoidFunction = () => {\n    if (this.state.active) {\n      this.setState({\n        active: false,\n        ts: null,\n      });\n    }\n    if (this.getStorage()) {\n      clearTimeout(this.getStorage().activeTimeout);\n      delete storage[this.id];\n    }\n  };\n\n  /*\n   * Возвращает хранилище для экземпляра компонента\n   */\n  getStorage: GetStorage = () => {\n    return storage[this.id];\n  };\n\n  /*\n   * Берет ref на DOM-ноду из экземпляра Touch\n   */\n  getRef: RefCallback<HTMLElement> = (container) => {\n    this.container = container;\n    setRef(container, this.props.getRootRef);\n  };\n\n  componentWillUnmount() {\n    if (storage[this.id]) {\n      clearTimeout(storage[this.id].timeout);\n      clearTimeout(storage[this.id].activeTimeout);\n\n      delete storage[this.id];\n    }\n\n    clearTimeout(this.wavesTimeout);\n  }\n\n  componentDidUpdate(prevProps: TappableProps) {\n    if (prevProps.hasHover !== this.props.hasHover || prevProps.hasActive !== this.props.hasActive) {\n      this.setState({ hasHover: this.props.hasHover, hasActive: this.props.hasActive });\n    }\n    if (!prevProps.disabled && this.props.disabled) {\n      this.setState({ hovered: false });\n    }\n  }\n\n  render() {\n    const { clicks, active, hovered, hasHover, hasActive } = this.state;\n\n    const defaultComponent: ElementType = this.props.href ? 'a' : 'div';\n\n    const {\n      children,\n      Component = defaultComponent,\n      onClick,\n      onKeyDown,\n      activeEffectDelay,\n      stopPropagation,\n      getRootRef,\n      platform,\n      sizeX,\n      hasMouse,\n      hasHover: propsHasHover,\n      hoverMode,\n      hasActive: propsHasActive,\n      activeMode,\n      hasFocusVisible,\n      ...restProps\n    } = this.props;\n\n    const isCustomElement: boolean = Component !== 'a' && Component !== 'button' && !restProps.contentEditable;\n\n    const isPresetHoverMode = ['opacity', 'background'].includes(hoverMode);\n    const isPresetActiveMode = ['opacity', 'background'].includes(activeMode);\n\n    const classes = classNames(\n      getClassName('Tappable', platform),\n      `Tappable--sizeX-${sizeX}`,\n      {\n        'Tappable--active': hasActive && active,\n        'Tappable--inactive': !active,\n        'Tappable--mouse': hasMouse,\n        [`Tappable--hover-${hoverMode}`]: hasHover && hovered && isPresetHoverMode,\n        [`Tappable--active-${activeMode}`]: hasActive && active && isPresetActiveMode,\n        'Tappable--focus-visible': hasFocusVisible,\n        [hoverMode]: hasHover && hovered && !isPresetHoverMode,\n        [activeMode]: hasActive && active && !isPresetActiveMode,\n      });\n\n    const RootComponent = restProps.disabled\n      ? Component\n      : Touch;\n\n    let props: RootComponentProps = {};\n    if (!restProps.disabled) {\n      props.Component = Component;\n      /* eslint-disable */\n      props.onStart = this.onStart;\n      props.onMove = this.onMove;\n      props.onEnd = this.onEnd;\n      props.onClick = onClick;\n      props.onKeyDown = isCustomElement ? this.onKeyDown : onKeyDown;\n      /* eslint-enable */\n      props.getRootRef = this.getRef;\n    } else {\n      props.ref = this.getRef;\n    }\n\n    if (isCustomElement) {\n      props['aria-disabled'] = restProps.disabled;\n    }\n\n    const role: string = restProps.href ? 'link' : 'button';\n\n    return (\n      <TappableContext.Consumer>\n        {({ insideTappable, onEnter, onLeave }) => {\n          return (\n            <TouchRootContext.Consumer>\n              {(insideTouchRoot: boolean) => {\n                this.insideTouchRoot = insideTouchRoot;\n                const touchProps = restProps.disabled ? {} : {\n                  onEnter: () => {\n                    insideTappable && onEnter();\n                    !restProps.disabled && this.onEnter();\n                  },\n                  onLeave: () => {\n                    insideTappable && onLeave();\n                    !restProps.disabled && this.onLeave();\n                  },\n                };\n                return (\n                  <RootComponent\n                    {...touchProps}\n                    type={Component === 'button' ? 'button' : undefined}\n                    tabIndex={isCustomElement && !restProps.disabled ? 0 : undefined}\n                    role={isCustomElement ? role : undefined}\n                    {...restProps}\n                    vkuiClass={classes}\n                    {...props}>\n                    <TappableContext.Provider\n                      value={{\n                        insideTappable: true,\n                        onEnter: () => this.setState({ hasHover: false, hasActive: false }),\n                        onLeave: () => this.setState({ hasHover: propsHasHover, hasActive: propsHasActive }),\n                      }}\n                    >\n                      {children}\n                    </TappableContext.Provider>\n                    {platform === ANDROID && !hasMouse && hasActive && activeMode === 'background' && (\n                      <span aria-hidden=\"true\" vkuiClass=\"Tappable__waves\">\n                        {Object.keys(clicks).map((k: string) => (\n                          <span vkuiClass=\"Tappable__wave\" style={{ top: clicks[k].y, left: clicks[k].x }} key={k} />\n                        ))}\n                      </span>\n                    )}\n                    {hasHover && <span aria-hidden=\"true\" vkuiClass=\"Tappable__hoverShadow\" />}\n                  </RootComponent>\n                );\n              }}\n            </TouchRootContext.Consumer>\n          );\n        }}\n      </TappableContext.Consumer>\n    );\n  }\n}\n\nexport default withAdaptivity(withPlatform(Tappable), { sizeX: true, hasMouse: true });\n"],"file":"Tappable.js"}