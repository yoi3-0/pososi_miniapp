{"version":3,"sources":["../../../src/components/CustomSelect/CustomSelect.tsx"],"names":["React","createRef","SelectMimicry","debounce","setRef","classNames","CustomScrollView","SizeType","withAdaptivity","withPlatform","CustomSelectOption","getClassName","Input","Icon20Dropdown","Icon24Dropdown","Caption","warnOnce","warn","CustomSelect","props","keyboardInput","state","selectedOptionIndex","options","length","setState","opened","focusedOptionIndex","isValidIndex","scrollToElement","resetKeyboardInput","inputValue","select","index","item","nativeSelectValue","value","event","Event","bubbles","selectEl","dispatchEvent","close","open","oldIndex","type","focusOptionByIndex","e","Array","prototype","indexOf","call","currentTarget","parentNode","children","preventDefault","key","fullInput","optionIndex","findIndex","option","label","toLowerCase","includes","scrollBoxRef","current","contains","target","isControlledOutside","findSelectedIndex","onChange","onInputChange","process","env","NODE_ENV","filter","filterFn","focusOption","selectFocused","onKeyboardInput","renderOption","hovered","selected","onClick","onMouseDown","handleOptionDown","onMouseEnter","handleOptionHover","element","getRef","defaultValue","initialValue","undefined","Number","center","dropdown","dropdownHeight","offsetHeight","scrollTop","itemTop","offsetTop","itemHeight","prevProps","searchable","name","className","getRootRef","popupDirection","sizeY","platform","style","onBlur","onFocus","emptyText","restProps","getSelectedItem","onLabelClick","onInputKeyDown","COMPACT","placeholder","handleKeyDownSelect","handleKeyUp","selectRef","onNativeSelectChange","map","resetFocusedOption","Component"],"mappings":"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","sourcesContent":["import React, {\n  ChangeEvent,\n  ChangeEventHandler,\n  createRef,\n  KeyboardEvent,\n  KeyboardEventHandler,\n  MouseEvent,\n  ReactNode,\n  SelectHTMLAttributes,\n} from 'react';\nimport SelectMimicry from '../SelectMimicry/SelectMimicry';\nimport { debounce, setRef } from '../../lib/utils';\nimport { classNames } from '../../lib/classNames';\nimport { NativeSelectProps } from '../NativeSelect/NativeSelect';\nimport CustomScrollView from '../CustomScrollView/CustomScrollView';\nimport { SizeType, withAdaptivity } from '../../hoc/withAdaptivity';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport CustomSelectOption, { CustomSelectOptionProps } from '../CustomSelectOption/CustomSelectOption';\nimport { getClassName } from '../../helpers/getClassName';\nimport { FormFieldProps } from '../FormField/FormField';\nimport { HasPlatform } from '../../types';\nimport Input from '../Input/Input';\nimport { Icon20Dropdown, Icon24Dropdown } from '@vkontakte/icons';\nimport Caption from '../Typography/Caption/Caption';\nimport { warnOnce } from '../../lib/warnOnce';\n\ntype SelectValue = SelectHTMLAttributes<HTMLSelectElement>['value'];\n\nexport interface CustomSelectOptionInterface {\n  value: SelectValue;\n  label: string;\n  [index: string]: any;\n}\n\ninterface CustomSelectState {\n  inputValue?: string;\n  opened?: boolean;\n  focusedOptionIndex?: number;\n  selectedOptionIndex?: number;\n  nativeSelectValue?: SelectValue;\n  options?: CustomSelectOptionInterface[];\n}\n\nexport interface CustomSelectProps extends NativeSelectProps, HasPlatform, FormFieldProps {\n  /**\n   * Если `true`, то при клике на селект в нём появится текстовое поле для поиска по `options`. По умолчанию поиск\n   * производится по `option.label`.\n   */\n  searchable?: boolean;\n  /**\n   * Текст, который будет отображен, если приходит пустой `options`\n   */\n  emptyText?: string;\n  onInputChange?: (e: ChangeEvent, options: CustomSelectOptionInterface[]) => void | CustomSelectOptionInterface[];\n  options: Array<{\n    value: SelectValue;\n    label: string;\n    [index: string]: any;\n  }>;\n  /**\n   * Функция для кастомной фильтрации. По-умолчанию поиск производится по option.label.\n   */\n  filterFn?: (value: string, option: CustomSelectOptionInterface) => boolean;\n  popupDirection?: 'top' | 'bottom';\n  /**\n   * В качестве аргумента принимает валидные для [CustomSelectOption](#/CustomSelectOption) свойства\n   */\n  renderOption?: (props: CustomSelectOptionProps) => ReactNode;\n}\n\ntype MouseEventHandler = (event: MouseEvent<HTMLElement>) => void;\n\nconst warn = warnOnce('CustomSelect');\n\nclass CustomSelect extends React.Component<CustomSelectProps, CustomSelectState> {\n  static defaultProps: CustomSelectProps = {\n    searchable: false,\n    renderOption(props: CustomSelectOptionProps): ReactNode {\n      return (\n        <CustomSelectOption {...props} />\n      );\n    },\n    options: [],\n    emptyText: 'Ничего не найдено',\n    filterFn: (value, option) => option.label.toLowerCase().includes(value.toLowerCase()),\n  };\n\n  public constructor(props: CustomSelectProps) {\n    super(props);\n\n    const { value, defaultValue } = props;\n\n    const initialValue = value !== undefined ? value : defaultValue;\n\n    this.keyboardInput = '';\n\n    this.state = {\n      opened: false,\n      focusedOptionIndex: -1,\n      selectedOptionIndex: this.findSelectedIndex(props.options, initialValue),\n      nativeSelectValue: initialValue,\n      options: props.options,\n      inputValue: '',\n    };\n\n    if (props.value !== undefined) {\n      this.isControlledOutside = true;\n    }\n  }\n\n  public state: CustomSelectState;\n  private keyboardInput: string;\n  private isControlledOutside: boolean;\n  private selectEl: HTMLSelectElement;\n  private readonly scrollBoxRef = createRef<HTMLDivElement>();\n\n  private readonly resetKeyboardInput = () => {\n    this.keyboardInput = '';\n  };\n\n  private readonly getSelectedItem = () => {\n    const { selectedOptionIndex, options } = this.state;\n\n    if (!options.length) {\n      return null;\n    }\n\n    return options[selectedOptionIndex];\n  };\n\n  findSelectedIndex(options: CustomSelectOptionInterface[], value: SelectValue) {\n    return options.findIndex((item) => {\n      value = typeof item.value === 'number' ? Number(value) : value;\n      return item.value === value;\n    });\n  }\n\n  open = () => {\n    this.setState(({ selectedOptionIndex }) => ({\n      opened: true,\n      focusedOptionIndex: selectedOptionIndex,\n    }), () => {\n      const { selectedOptionIndex } = this.state;\n\n      if (this.isValidIndex(selectedOptionIndex)) {\n        this.scrollToElement(selectedOptionIndex, true);\n      }\n    });\n  };\n\n  close = () => {\n    this.resetKeyboardInput();\n\n    this.setState(() => ({\n      inputValue: '',\n      opened: false,\n      focusedOptionIndex: -1,\n      options: this.props.options,\n    }));\n  };\n\n  private isValidIndex(index: number) {\n    return index >= 0 && index < this.state.options.length;\n  }\n\n  selectFocused = () => {\n    const { focusedOptionIndex } = this.state;\n\n    this.select(focusedOptionIndex);\n  };\n\n  select = (index: number) => {\n    if (!this.isValidIndex(index)) {\n      return;\n    }\n\n    const item = this.state.options[index];\n\n    this.setState({\n      nativeSelectValue: item.value,\n    }, () => {\n      const event = new Event('change', { bubbles: true });\n      this.selectEl.dispatchEvent(event);\n    });\n    this.close();\n  };\n\n  onClick = () => {\n    this.state.opened ? this.close() : this.open();\n  };\n\n  onFocus = () => {\n    const event = new Event('focus');\n    this.selectEl.dispatchEvent(event);\n  };\n\n  onBlur = () => {\n    this.resetKeyboardInput();\n\n    this.setState(() => ({\n      opened: false,\n      options: this.props.options,\n    }));\n\n    const event = new Event('blur');\n    this.selectEl.dispatchEvent(event);\n  };\n\n  private scrollToElement(index: number, center = false) {\n    const dropdown = this.scrollBoxRef.current;\n    const item = dropdown ? (dropdown.children[index] as HTMLElement) : null;\n\n    if (!item) {\n      return;\n    }\n\n    const dropdownHeight = dropdown.offsetHeight;\n    const scrollTop = dropdown.scrollTop;\n    const itemTop = item.offsetTop;\n    const itemHeight = item.offsetHeight;\n\n    if (center) {\n      dropdown.scrollTop = itemTop - dropdownHeight / 2 + itemHeight / 2;\n    } else if (itemTop + itemHeight > dropdownHeight + scrollTop) {\n      dropdown.scrollTop = itemTop - dropdownHeight + itemHeight;\n    } else if (itemTop < scrollTop) {\n      dropdown.scrollTop = itemTop;\n    }\n  }\n\n  focusOptionByIndex = (index: number) => {\n    const { focusedOptionIndex } = this.state;\n    const oldIndex = focusedOptionIndex;\n\n    if (index < 0) {\n      index = this.state.options.length - 1;\n    } else if (index >= this.state.options.length) {\n      index = 0;\n    }\n\n    if (index === oldIndex) {\n      return;\n    }\n\n    this.scrollToElement(index);\n\n    this.setState(() => ({\n      focusedOptionIndex: index,\n    }));\n  };\n\n  focusOption = (type: 'next' | 'prev') => {\n    const { focusedOptionIndex } = this.state;\n    let index = focusedOptionIndex;\n\n    if (type === 'next') {\n      index = focusedOptionIndex + 1;\n    } else if (type === 'prev') {\n      index = focusedOptionIndex - 1;\n    }\n\n    this.focusOptionByIndex(index);\n  };\n\n  handleOptionHover: MouseEventHandler = (e: MouseEvent<HTMLElement>) => {\n    this.setState({\n      focusedOptionIndex: Array.prototype.indexOf.call(e.currentTarget.parentNode.children, e.currentTarget),\n    });\n  };\n\n  handleOptionDown: MouseEventHandler = (e: MouseEvent<HTMLElement>) => {\n    e.preventDefault();\n  };\n\n  resetFocusedOption = () => {\n    this.setState(() => ({\n      focusedOptionIndex: -1,\n    }));\n  };\n\n  onKeyboardInput = (key: string) => {\n    const fullInput = this.keyboardInput + key;\n\n    const optionIndex = this.state.options.findIndex((option) => {\n      return option.label.toLowerCase().includes(fullInput);\n    });\n\n    if (optionIndex > -1) {\n      this.focusOptionByIndex(optionIndex);\n    }\n\n    this.keyboardInput = fullInput;\n  };\n\n  /**\n   * Нужен для правильного поведения обработчика onClick на select. Фильтрует клики, которые были сделаны по\n   * выпадающему списку.\n   */\n  onLabelClick = (e: MouseEvent<HTMLLabelElement>) => {\n    if (this.scrollBoxRef.current?.contains(e.target as Node)) {\n      e.preventDefault();\n    }\n  };\n\n  onNativeSelectChange: ChangeEventHandler<HTMLSelectElement> = (e) => {\n    const value = e.currentTarget.value;\n    if (!this.isControlledOutside) {\n      this.setState({\n        selectedOptionIndex: this.findSelectedIndex(this.state.options, value),\n      });\n    }\n    if (this.props.onChange) {\n      this.props.onChange(e);\n    }\n  };\n\n  onInputChange: ChangeEventHandler<HTMLInputElement> = (e) => {\n    if (this.props.onInputChange) {\n      const options = this.props.onInputChange(e, this.props.options);\n      if (options) {\n        if (process.env.NODE_ENV === 'development') {\n          warn('This filtration method is deprecated. Return value of onInputChange will' +\n            ' be ignored in v5.0.0. For custom filtration please update props.options by yourself or use filterFn property');\n        }\n        this.setState({\n          options,\n          selectedOptionIndex: this.findSelectedIndex(options, this.state.nativeSelectValue),\n          inputValue: e.target.value,\n        });\n      } else {\n        this.setState({ inputValue: e.target.value });\n      }\n    } else {\n      const options = this.props.options.filter((option) => this.props.filterFn(e.target.value, option));\n      this.setState({\n        options,\n        selectedOptionIndex: this.findSelectedIndex(options, this.state.nativeSelectValue),\n        inputValue: e.target.value,\n      });\n    }\n  };\n\n  onInputKeyDown: KeyboardEventHandler<HTMLInputElement> = (event) => {\n    switch (event.key) {\n      case 'ArrowUp':\n        event.preventDefault();\n        this.focusOption('prev');\n        break;\n      case 'ArrowDown':\n        event.preventDefault();\n        this.focusOption('next');\n        break;\n      case 'Escape':\n        event.preventDefault();\n        this.close();\n        break;\n      case 'Enter':\n        event.preventDefault();\n        this.selectFocused();\n        break;\n    }\n  };\n\n  handleKeyDownSelect = (event: KeyboardEvent) => {\n    const { opened } = this.state;\n\n    if (event.key.length === 1 && event.key !== ' ') {\n      this.onKeyboardInput(event.key);\n\n      return;\n    }\n\n    switch (event.key) {\n      case 'ArrowUp':\n        event.preventDefault();\n        opened ? this.focusOption('prev') : this.open();\n        break;\n      case 'ArrowDown':\n        event.preventDefault();\n        opened ? this.focusOption('next') : this.open();\n        break;\n      case 'Escape':\n        event.preventDefault();\n        this.close();\n        break;\n      case 'Enter':\n      case 'Spacebar':\n      case ' ':\n        event.preventDefault();\n        opened ? this.selectFocused() : this.open();\n        break;\n    }\n  };\n\n  handleKeyUp = debounce(this.resetKeyboardInput, 1000);\n\n  componentDidUpdate(prevProps: CustomSelectProps) {\n    if (prevProps.value !== this.props.value || prevProps.options !== this.props.options) {\n      this.isControlledOutside = this.props.value !== undefined;\n      const value = this.props.value === undefined ? this.state.nativeSelectValue : this.props.value;\n      const options = this.props.searchable ? this.props.options.filter((option) => this.props.filterFn(this.state.inputValue, option)) : this.props.options;\n      this.setState({\n        nativeSelectValue: value,\n        selectedOptionIndex: this.findSelectedIndex(options, value),\n        options,\n      });\n    }\n  }\n\n  renderOption = (option: CustomSelectOptionInterface, index: number) => {\n    const { focusedOptionIndex, selectedOptionIndex } = this.state;\n    const { renderOption } = this.props;\n    const hovered = index === focusedOptionIndex;\n    const selected = index === selectedOptionIndex;\n\n    return (\n      <React.Fragment key={`${option.value}`}>\n        {renderOption({\n          option,\n          hovered,\n          children: option.label,\n          selected,\n          onClick: this.selectFocused,\n          onMouseDown: this.handleOptionDown,\n          onMouseEnter: this.handleOptionHover,\n        })}\n      </React.Fragment>\n    );\n  };\n\n  selectRef = (element: HTMLSelectElement) => {\n    this.selectEl = element;\n    setRef(element, this.props.getRef);\n  };\n\n  render() {\n    const { opened, nativeSelectValue } = this.state;\n    const {\n      searchable,\n      name,\n      className,\n      getRef,\n      getRootRef,\n      popupDirection,\n      options,\n      sizeY,\n      platform,\n      style,\n      onChange,\n      onBlur,\n      onFocus,\n      onClick,\n      renderOption,\n      children,\n      emptyText,\n      onInputChange,\n      filterFn,\n      ...restProps\n    } = this.props;\n    const selected = this.getSelectedItem();\n    const label = selected ? selected.label : undefined;\n\n    return (\n      <label\n        vkuiClass={getClassName('CustomSelect', platform)}\n        className={className}\n        style={style}\n        ref={getRootRef}\n        onClick={this.onLabelClick}\n      >\n        {opened && searchable ?\n          <Input\n            {...restProps}\n            autoFocus\n            onBlur={this.onBlur}\n            vkuiClass={classNames({\n              'CustomSelect__open': opened,\n              'CustomSelect__open--popupDirectionTop': popupDirection === 'top',\n            })}\n            value={this.state.inputValue}\n            onKeyDown={this.onInputKeyDown}\n            onChange={this.onInputChange}\n            // TODO Ожидается, что клик поймает нативный select, но его перехвает Input. К сожалению, это приводит конфликтам типизации.\n            // TODO Нужно перестать пытаться превратить CustomSelect в select. Тогда эта проблема уйдёт.\n            // @ts-ignore\n            onClick={onClick}\n            after={sizeY === SizeType.COMPACT ? <Icon20Dropdown /> : <Icon24Dropdown />}\n            placeholder={restProps.placeholder}\n          /> :\n          <SelectMimicry\n            {...restProps}\n            aria-hidden={true}\n            onClick={this.onClick}\n            onKeyDown={this.handleKeyDownSelect}\n            onKeyUp={this.handleKeyUp}\n            onFocus={this.onFocus}\n            onBlur={this.onBlur}\n            vkuiClass={classNames({\n              'CustomSelect__open': opened,\n              'CustomSelect__open--popupDirectionTop': popupDirection === 'top',\n            })}\n            className={className}\n          >\n            {label}\n          </SelectMimicry>\n        }\n        <select\n          ref={this.selectRef}\n          name={name}\n          onChange={this.onNativeSelectChange}\n          onBlur={onBlur}\n          onFocus={onFocus}\n          onClick={onClick}\n          value={nativeSelectValue}\n          aria-hidden={true}\n          vkuiClass=\"CustomSelect__control\"\n        >\n          {options.map((item) => <option key={`${item.value}`} value={item.value} />)}\n        </select>\n        {opened &&\n        <div\n          vkuiClass={classNames('CustomSelect__options', `CustomSelect__options--sizeY-${sizeY}`, {\n            'CustomSelect__options--popupDirectionTop': popupDirection === 'top',\n          })}\n          onMouseLeave={this.resetFocusedOption}\n        >\n          <CustomScrollView boxRef={this.scrollBoxRef}>\n            {this.state.options.map(this.renderOption)}\n            {this.state.options.length === 0 &&\n              <Caption level=\"1\" weight=\"regular\" vkuiClass=\"CustomSelect__empty\">\n                {emptyText}\n              </Caption>\n            }\n          </CustomScrollView>\n        </div>\n        }\n      </label>\n    );\n  }\n}\n\nexport default withPlatform(withAdaptivity(CustomSelect, {\n  sizeY: true,\n}));\n"],"file":"CustomSelect.js"}