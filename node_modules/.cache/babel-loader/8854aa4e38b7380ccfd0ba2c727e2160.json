{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport { createContext, useContext, useRef } from 'react';\nimport { useIsomorphicLayoutEffect } from \"../../lib/useIsomorphicLayoutEffect\";\nexport var ModalRootContext = /*#__PURE__*/createContext({\n  updateModalHeight: function updateModalHeight() {\n    return undefined;\n  },\n  registerModal: function registerModal() {\n    return undefined;\n  },\n  isInsideModal: false\n});\n/**\n * All referenced elements must be static\n */\n\nexport function useModalRegistry(id, type) {\n  var modalContext = useContext(ModalRootContext);\n  var elements = useRef({}).current;\n  useIsomorphicLayoutEffect(function () {\n    modalContext.registerModal(_objectSpread(_objectSpread({}, elements), {}, {\n      type: type,\n      id: id\n    })); // unset refs on  unmount to prevent leak\n\n    var reset = Object.keys(elements).reduce(function (acc, k) {\n      return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, k, null));\n    }, {\n      type: type,\n      id: id\n    });\n    return function () {\n      return modalContext.registerModal(reset);\n    };\n  }, []);\n  var refs = useRef({\n    modalElement: function modalElement(e) {\n      return elements.modalElement = e;\n    },\n    innerElement: function innerElement(e) {\n      return elements.innerElement = e;\n    },\n    headerElement: function headerElement(e) {\n      return elements.headerElement = e;\n    },\n    contentElement: function contentElement(e) {\n      return elements.contentElement = e;\n    },\n    footerElement: function footerElement(e) {\n      return elements.footerElement = e;\n    }\n  }).current;\n  return {\n    refs: refs\n  };\n}\nexport default ModalRootContext;","map":{"version":3,"sources":["../../../src/components/ModalRoot/ModalRootContext.tsx"],"names":["ModalRootContext","createContext","updateModalHeight","registerModal","isInsideModal","modalContext","useContext","elements","useRef","useIsomorphicLayoutEffect","type","id","reset","refs","modalElement","innerElement","headerElement","contentElement","footerElement"],"mappings":";;AAAA,SAAA,aAAA,EAAA,UAAA,EAAA,MAAA,QAAA,OAAA;AACA,SAAA,yBAAA,QAAA,qCAAA;AAaA,OAAO,IAAMA,gBAAgB,GAAA,aAAGC,aAAa,CAA4B;AACvEC,EAAAA,iBAAiB,EAAE,SAAA,iBAAA,GAAA;AAAA,WAAA,SAAA;AADoD,GAAA;AAEvEC,EAAAA,aAAa,EAAE,SAAA,aAAA,GAAA;AAAA,WAAA,SAAA;AAFwD,GAAA;AAGvEC,EAAAA,aAAa,EAAE;AAHwD,CAA5B,CAAtC;AAMP;;;;AAGA,OAAO,SAAA,gBAAA,CAAA,EAAA,EAAA,IAAA,EAAuD;AAC5D,MAAMC,YAAY,GAAGC,UAAU,CAA/B,gBAA+B,CAA/B;AACA,MAAMC,QAAQ,GAAGC,MAAM,CAANA,EAAM,CAANA,CAAjB,OAAA;AACAC,EAAAA,yBAAyB,CAAC,YAAM;AAC9BJ,IAAAA,YAAY,CAAZA,aAAAA,CAAAA,aAAAA,CAAAA,aAAAA,CAAAA,EAAAA,EAAAA,QAAAA,CAAAA,EAAAA,EAAAA,EAAAA;AAA0CK,MAAAA,IAAI,EAA9CL,IAAAA;AAAgDM,MAAAA,EAAE,EAAFA;AAAhDN,KAAAA,CAAAA,EAD8B,CAE9B;;AACA,QAAMO,KAAK,GAAG,MAAM,CAAN,IAAA,CAAA,QAAA,EAAA,MAAA,CACZ,UAAA,GAAA,EAAA,CAAA,EAAA;AAAA,aAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EAAA,GAAA,CAAA,EAAA,EAAA,EAAA,eAAA,CAAA,EAAA,EAAA,CAAA,EAAA,IAAA,CAAA,CAAA;AADY,KAAA,EAEZ;AAAEF,MAAAA,IAAI,EAAN,IAAA;AAAQC,MAAAA,EAAE,EAAFA;AAAR,KAFY,CAAd;AAGA,WAAO,YAAA;AAAA,aAAMN,YAAY,CAAZA,aAAAA,CAAN,KAAMA,CAAN;AAAP,KAAA;AANuB,GAAA,EAAzBI,EAAyB,CAAzBA;AASA,MAAMI,IAAI,GAAG,MAAM,CAAsB;AACvCC,IAAAA,YAAY,EAAE,SAAA,YAAA,CAAA,CAAA,EAAA;AAAA,aAAOP,QAAQ,CAARA,YAAAA,GAAP,CAAA;AADyB,KAAA;AAEvCQ,IAAAA,YAAY,EAAE,SAAA,YAAA,CAAA,CAAA,EAAA;AAAA,aAAOR,QAAQ,CAARA,YAAAA,GAAP,CAAA;AAFyB,KAAA;AAGvCS,IAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,CAAA,EAAA;AAAA,aAAOT,QAAQ,CAARA,aAAAA,GAAP,CAAA;AAHwB,KAAA;AAIvCU,IAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,CAAA,EAAA;AAAA,aAAOV,QAAQ,CAARA,cAAAA,GAAP,CAAA;AAJuB,KAAA;AAKvCW,IAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,CAAA,EAAA;AAAA,aAAOX,QAAQ,CAARA,aAAAA,GAAP,CAAA;AAAA;AALwB,GAAtB,CAAN,CAAb,OAAA;AAOA,SAAO;AAAEM,IAAAA,IAAI,EAAJA;AAAF,GAAP;AACD;AAED,eAAA,gBAAA","sourcesContent":["import { createContext, useContext, useRef } from 'react';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { ModalElements, ModalsStateEntry, ModalType } from './types';\n\nexport type ModalRegistryEntry = ModalElements & Required<Pick<ModalsStateEntry, 'type' | 'id'>>;\ntype ModalRefs = { [k in keyof ModalElements]: (e: ModalElements[k]) => void };\n\nexport interface ModalRootContextInterface {\n  updateModalHeight: VoidFunction;\n  registerModal(data: ModalRegistryEntry): void;\n  onClose?: VoidFunction;\n  isInsideModal: boolean;\n}\n\nexport const ModalRootContext = createContext<ModalRootContextInterface>({\n  updateModalHeight: () => undefined,\n  registerModal: () => undefined,\n  isInsideModal: false,\n});\n\n/**\n * All referenced elements must be static\n */\nexport function useModalRegistry(id: string, type: ModalType) {\n  const modalContext = useContext(ModalRootContext);\n  const elements = useRef<ModalElements>({}).current;\n  useIsomorphicLayoutEffect(() => {\n    modalContext.registerModal({ ...elements, type, id });\n    // unset refs on  unmount to prevent leak\n    const reset = Object.keys(elements).reduce<ModalRegistryEntry>(\n      (acc, k: keyof ModalElements) => ({ ...acc, [k]: null }),\n      { type, id });\n    return () => modalContext.registerModal(reset);\n  }, []);\n\n  const refs = useRef<Required<ModalRefs>>({\n    modalElement: (e) => elements.modalElement = e,\n    innerElement: (e) => elements.innerElement = e,\n    headerElement: (e) => elements.headerElement = e,\n    contentElement: (e) => elements.contentElement = e,\n    footerElement: (e) => elements.footerElement = e,\n  }).current;\n  return { refs };\n}\n\nexport default ModalRootContext;\n"]},"metadata":{},"sourceType":"module"}