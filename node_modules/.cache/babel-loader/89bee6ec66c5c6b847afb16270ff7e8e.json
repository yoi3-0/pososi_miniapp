{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport { useEffect, useRef, useState } from 'react';\nimport { hasMouse as _hasMouse } from '@vkontakte/vkjs';\nimport { AdaptivityContext, SizeType, ViewHeight, ViewWidth } from \"./AdaptivityContext\";\nimport { canUseDOM, useDOM } from \"../../lib/dom\";\nexport var DESKTOP_SIZE = 1280;\nexport var TABLET_SIZE = 1024;\nexport var SMALL_TABLET_SIZE = 768;\nexport var MOBILE_SIZE = 320;\nexport var MOBILE_LANDSCAPE_HEIGHT = 414;\nexport var MEDIUM_HEIGHT = 720;\nexport default function AdaptivityProvider(props) {\n  var adaptivityRef = useRef(null);\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      updateAdaptivity = _useState2[1];\n\n  var _useDOM = useDOM(),\n      window = _useDOM.window;\n\n  if (!adaptivityRef.current) {\n    adaptivityRef.current = calculateAdaptivity(window ? window.innerWidth : 0, window ? window.innerHeight : 0, props);\n  }\n\n  useEffect(function () {\n    function onResize() {\n      var calculated = calculateAdaptivity(window.innerWidth, window.innerHeight, props);\n      var _adaptivityRef$curren = adaptivityRef.current,\n          viewWidth = _adaptivityRef$curren.viewWidth,\n          viewHeight = _adaptivityRef$curren.viewHeight,\n          sizeX = _adaptivityRef$curren.sizeX,\n          sizeY = _adaptivityRef$curren.sizeY,\n          hasMouse = _adaptivityRef$curren.hasMouse;\n\n      if (viewWidth !== calculated.viewWidth || viewHeight !== calculated.viewHeight || sizeX !== calculated.sizeX || sizeY !== calculated.sizeY || hasMouse !== calculated.hasMouse) {\n        adaptivityRef.current = calculated;\n        updateAdaptivity({});\n      }\n    }\n\n    onResize();\n    window.addEventListener('resize', onResize, false);\n    return function () {\n      window.removeEventListener('resize', onResize, false);\n    };\n  }, [props.viewWidth, props.viewHeight, props.sizeX, props.sizeY, props.hasMouse]);\n  return createScopedElement(AdaptivityContext.Provider, {\n    value: adaptivityRef.current\n  }, props.children);\n}\nAdaptivityProvider.defaultProps = {\n  window: canUseDOM && window\n};\n\nfunction calculateAdaptivity(windowWidth, windowHeight, props) {\n  var viewWidth = ViewWidth.SMALL_MOBILE;\n  var viewHeight = ViewHeight.SMALL;\n  var sizeY = SizeType.REGULAR;\n  var sizeX = SizeType.REGULAR;\n  var hasMouse = typeof props.hasMouse === 'boolean' ? props.hasMouse : _hasMouse;\n\n  if (windowWidth >= DESKTOP_SIZE) {\n    viewWidth = ViewWidth.DESKTOP;\n  } else if (windowWidth >= TABLET_SIZE) {\n    viewWidth = ViewWidth.TABLET;\n  } else if (windowWidth >= SMALL_TABLET_SIZE) {\n    viewWidth = ViewWidth.SMALL_TABLET;\n  } else if (windowWidth >= MOBILE_SIZE) {\n    viewWidth = ViewWidth.MOBILE;\n  } else {\n    viewWidth = ViewWidth.SMALL_MOBILE;\n  }\n\n  if (windowHeight >= MEDIUM_HEIGHT) {\n    viewHeight = ViewHeight.MEDIUM;\n  } else if (windowHeight > MOBILE_LANDSCAPE_HEIGHT) {\n    viewHeight = ViewHeight.SMALL;\n  } else {\n    viewHeight = ViewHeight.EXTRA_SMALL;\n  }\n\n  props.viewWidth && (viewWidth = props.viewWidth);\n  props.viewHeight && (viewHeight = props.viewHeight);\n\n  if (viewWidth <= ViewWidth.MOBILE) {\n    sizeX = SizeType.COMPACT;\n  }\n\n  if (viewWidth >= ViewWidth.SMALL_TABLET && hasMouse || viewHeight <= ViewHeight.EXTRA_SMALL) {\n    sizeY = SizeType.COMPACT;\n  }\n\n  props.sizeX && (sizeX = props.sizeX);\n  props.sizeY && (sizeY = props.sizeY);\n  return {\n    viewWidth: viewWidth,\n    viewHeight: viewHeight,\n    sizeX: sizeX,\n    sizeY: sizeY,\n    hasMouse: hasMouse\n  };\n}","map":{"version":3,"sources":["../../../src/components/AdaptivityProvider/AdaptivityProvider.tsx"],"names":["hasMouse","DESKTOP_SIZE","TABLET_SIZE","SMALL_TABLET_SIZE","MOBILE_SIZE","MOBILE_LANDSCAPE_HEIGHT","MEDIUM_HEIGHT","adaptivityRef","useRef","updateAdaptivity","useState","window","useDOM","calculateAdaptivity","useEffect","calculated","viewWidth","viewHeight","sizeX","sizeY","onResize","props","current","AdaptivityProvider","canUseDOM","ViewWidth","ViewHeight","SizeType","windowWidth","windowHeight"],"mappings":"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","sourcesContent":["import { ReactNode, useEffect, useRef, useState } from 'react';\nimport { hasMouse as _hasMouse } from '@vkontakte/vkjs';\nimport { AdaptivityContext, AdaptivityContextInterface, SizeType, ViewHeight, ViewWidth } from './AdaptivityContext';\nimport { canUseDOM, useDOM } from '../../lib/dom';\n\nexport interface AdaptivityProviderProps extends AdaptivityContextInterface {\n  children?: ReactNode;\n}\n\nexport const DESKTOP_SIZE = 1280;\nexport const TABLET_SIZE = 1024;\nexport const SMALL_TABLET_SIZE = 768;\nexport const MOBILE_SIZE = 320;\n\nexport const MOBILE_LANDSCAPE_HEIGHT = 414;\nexport const MEDIUM_HEIGHT = 720;\n\nexport default function AdaptivityProvider(props: AdaptivityProviderProps) {\n  const adaptivityRef = useRef<AdaptivityContextInterface>(null);\n  const [, updateAdaptivity] = useState({});\n\n  const { window } = useDOM();\n\n  if (!adaptivityRef.current) {\n    adaptivityRef.current = calculateAdaptivity(\n      window ? window.innerWidth : 0,\n      window ? window.innerHeight : 0,\n      props,\n    );\n  }\n\n  useEffect(() => {\n    function onResize() {\n      const calculated = calculateAdaptivity(window.innerWidth, window.innerHeight, props);\n      const { viewWidth, viewHeight, sizeX, sizeY, hasMouse } = adaptivityRef.current;\n\n      if (\n        viewWidth !== calculated.viewWidth ||\n        viewHeight !== calculated.viewHeight ||\n        sizeX !== calculated.sizeX ||\n        sizeY !== calculated.sizeY ||\n        hasMouse !== calculated.hasMouse\n      ) {\n        adaptivityRef.current = calculated;\n        updateAdaptivity({});\n      }\n    }\n\n    onResize();\n    window.addEventListener('resize', onResize, false);\n\n    return () => {\n      window.removeEventListener('resize', onResize, false);\n    };\n  }, [props.viewWidth, props.viewHeight, props.sizeX, props.sizeY, props.hasMouse]);\n\n  return (\n    <AdaptivityContext.Provider value={adaptivityRef.current}>\n      {props.children}\n    </AdaptivityContext.Provider>\n  );\n}\n\nAdaptivityProvider.defaultProps = {\n  window: canUseDOM && window,\n};\n\nfunction calculateAdaptivity(windowWidth: number, windowHeight: number, props: AdaptivityProviderProps) {\n  let viewWidth = ViewWidth.SMALL_MOBILE;\n  let viewHeight = ViewHeight.SMALL;\n  let sizeY = SizeType.REGULAR;\n  let sizeX = SizeType.REGULAR;\n  let hasMouse = typeof props.hasMouse === 'boolean' ? props.hasMouse : _hasMouse;\n\n  if (windowWidth >= DESKTOP_SIZE) {\n    viewWidth = ViewWidth.DESKTOP;\n  } else if (windowWidth >= TABLET_SIZE) {\n    viewWidth = ViewWidth.TABLET;\n  } else if (windowWidth >= SMALL_TABLET_SIZE) {\n    viewWidth = ViewWidth.SMALL_TABLET;\n  } else if (windowWidth >= MOBILE_SIZE) {\n    viewWidth = ViewWidth.MOBILE;\n  } else {\n    viewWidth = ViewWidth.SMALL_MOBILE;\n  }\n\n  if (windowHeight >= MEDIUM_HEIGHT) {\n    viewHeight = ViewHeight.MEDIUM;\n  } else if (windowHeight > MOBILE_LANDSCAPE_HEIGHT) {\n    viewHeight = ViewHeight.SMALL;\n  } else {\n    viewHeight = ViewHeight.EXTRA_SMALL;\n  }\n\n  props.viewWidth && (viewWidth = props.viewWidth);\n  props.viewHeight && (viewHeight = props.viewHeight);\n\n  if (viewWidth <= ViewWidth.MOBILE) {\n    sizeX = SizeType.COMPACT;\n  }\n\n  if (viewWidth >= ViewWidth.SMALL_TABLET && hasMouse || viewHeight <= ViewHeight.EXTRA_SMALL) {\n    sizeY = SizeType.COMPACT;\n  }\n\n  props.sizeX && (sizeX = props.sizeX);\n  props.sizeY && (sizeY = props.sizeY);\n\n  return { viewWidth, viewHeight, sizeX, sizeY, hasMouse };\n}\n"]},"metadata":{},"sourceType":"module"}