{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport React, { useEffect, useRef, useState } from 'react';\nimport { classNames } from \"../../lib/classNames\";\nimport { getTitleFromChildren } from \"../../lib/utils\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { withAdaptivity } from \"../../hoc/withAdaptivity\";\nimport { useDOM } from \"../../lib/dom\";\nimport { ANDROID, IOS, VKCOM } from \"../../lib/platform\";\nimport { Icon24Cancel } from '@vkontakte/icons';\nimport IconButton from \"../IconButton/IconButton\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nexport var Removable = withAdaptivity(function (props) {\n  var children = props.children,\n      sizeY = props.sizeY,\n      onRemove = props.onRemove,\n      removePlaceholder = props.removePlaceholder,\n      align = props.align,\n      restProps = _objectWithoutProperties(props, [\"children\", \"sizeY\", \"onRemove\", \"removePlaceholder\", \"align\"]);\n\n  var platform = usePlatform();\n\n  var _useDOM = useDOM(),\n      document = _useDOM.document;\n\n  var removeButtonRef = useRef(null);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isRemoveActivated = _useState2[0],\n      setRemoveActivated = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      removeOffset = _useState4[0],\n      updateRemoveOffset = _useState4[1];\n\n  useGlobalEventListener(document, 'click', isRemoveActivated && function () {\n    setRemoveActivated(false);\n    updateRemoveOffset(0);\n  });\n\n  var onRemoveActivateClick = function onRemoveActivateClick(e) {\n    e.nativeEvent.stopPropagation();\n    e.preventDefault();\n    setRemoveActivated(true);\n  };\n\n  var onRemoveClick = function onRemoveClick(e) {\n    e.nativeEvent.stopImmediatePropagation();\n    e.preventDefault();\n    onRemove && onRemove(e);\n  };\n\n  useEffect(function () {\n    if (isRemoveActivated && (removeButtonRef === null || removeButtonRef === void 0 ? void 0 : removeButtonRef.current)) {\n      updateRemoveOffset(removeButtonRef.current.offsetWidth);\n    }\n  }, [isRemoveActivated]);\n  var removePlaceholderString = getTitleFromChildren(removePlaceholder);\n  return createScopedElement(\"div\", _extends({}, restProps, {\n    vkuiClass: classNames(getClassName('Removable', platform), \"Removable--\".concat(align), \"Removable--sizeY-\".concat(sizeY))\n  }), (platform === ANDROID || platform === VKCOM) && createScopedElement(\"div\", {\n    vkuiClass: \"Removable__content\"\n  }, children, createScopedElement(IconButton, {\n    \"aria-label\": removePlaceholderString,\n    vkuiClass: \"Removable__action Removable__action--remove\",\n    onClick: onRemoveClick\n  }, createScopedElement(Icon24Cancel, null))), platform === IOS && createScopedElement(React.Fragment, null, createScopedElement(\"div\", {\n    vkuiClass: \"Removable__content\",\n    style: {\n      transform: \"translateX(-\".concat(removeOffset, \"px)\")\n    }\n  }, createScopedElement(\"button\", {\n    type: \"button\",\n    \"aria-label\": removePlaceholderString,\n    vkuiClass: \"Removable__action Removable__action--indicator\",\n    onClick: onRemoveActivateClick\n  }, createScopedElement(\"i\", {\n    vkuiClass: \"Removable__action-in\",\n    role: \"presentation\"\n  })), children, createScopedElement(\"span\", {\n    vkuiClass: \"Removable__offset\",\n    \"aria-hidden\": \"true\"\n  })), createScopedElement(\"button\", {\n    type: \"button\",\n    tabIndex: isRemoveActivated ? null : -1,\n    ref: removeButtonRef,\n    vkuiClass: \"Removable__action Removable__action--remove\",\n    onClick: onRemoveClick,\n    style: {\n      transform: \"translateX(-\".concat(removeOffset, \"px)\")\n    }\n  }, createScopedElement(\"span\", {\n    vkuiClass: \"Removable__action-in\"\n  }, removePlaceholder))));\n}, {\n  sizeY: true\n});\nRemovable.defaultProps = {\n  align: 'center',\n  removePlaceholder: 'Удалить'\n};","map":{"version":3,"sources":["../../../src/components/Removable/Removable.tsx"],"names":["Removable","withAdaptivity","children","sizeY","onRemove","removePlaceholder","align","restProps","props","platform","usePlatform","document","useDOM","removeButtonRef","useRef","isRemoveActivated","setRemoveActivated","useState","removeOffset","updateRemoveOffset","useGlobalEventListener","onRemoveActivateClick","e","onRemoveClick","useEffect","removePlaceholderString","getTitleFromChildren","classNames","getClassName","transform"],"mappings":"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","sourcesContent":["import React, { AllHTMLAttributes, FC, ReactNode, MouseEvent, useEffect, useRef, useState } from 'react';\nimport { classNames } from '../../lib/classNames';\nimport { getTitleFromChildren } from '../../lib/utils';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { getClassName } from '../../helpers/getClassName';\nimport { withAdaptivity, AdaptivityProps } from '../../hoc/withAdaptivity';\nimport { useDOM } from '../../lib/dom';\nimport { ANDROID, IOS, VKCOM } from '../../lib/platform';\nimport { Icon24Cancel } from '@vkontakte/icons';\nimport IconButton from '../IconButton/IconButton';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\n\nexport interface RemovePlaceholderProps {\n  /**\n   * iOS only. Текст в выезжающей кнопке для удаления ячейки.\n   */\n  removePlaceholder?: ReactNode;\n}\n\ninterface RemovableProps extends AllHTMLAttributes<HTMLElement>, RemovePlaceholderProps {\n  /**\n   * Расположение кнопки удаления.\n   */\n  align?: 'start' | 'center';\n  onRemove?: (e: MouseEvent) => void;\n}\n\nexport const Removable: FC<RemovableProps> = withAdaptivity((props: RemovableProps & Pick<AdaptivityProps, 'sizeY'>) => {\n  const {\n    children,\n    sizeY,\n    onRemove,\n    removePlaceholder,\n    align,\n    ...restProps\n  } = props;\n  const platform = usePlatform();\n  const { document } = useDOM();\n\n  const removeButtonRef = useRef(null);\n\n  const [isRemoveActivated, setRemoveActivated] = useState(false);\n  const [removeOffset, updateRemoveOffset] = useState(0);\n\n  useGlobalEventListener(document, 'click', isRemoveActivated && (() => {\n    setRemoveActivated(false);\n    updateRemoveOffset(0);\n  }));\n\n  const onRemoveActivateClick = (e: MouseEvent) => {\n    e.nativeEvent.stopPropagation();\n    e.preventDefault();\n    setRemoveActivated(true);\n  };\n\n  const onRemoveClick = (e: MouseEvent) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.preventDefault();\n    onRemove && onRemove(e);\n  };\n\n  useEffect(() => {\n    if (isRemoveActivated && removeButtonRef?.current) {\n      updateRemoveOffset(removeButtonRef.current.offsetWidth);\n    }\n  }, [isRemoveActivated]);\n\n  const removePlaceholderString: string = getTitleFromChildren(removePlaceholder);\n\n  return (\n    <div\n      {...restProps}\n      vkuiClass={classNames(\n        getClassName('Removable', platform),\n        `Removable--${align}`,\n        `Removable--sizeY-${sizeY}`,\n      )}\n    >\n      {(platform === ANDROID || platform === VKCOM) && (\n        <div vkuiClass=\"Removable__content\">\n          {children}\n\n          <IconButton\n            aria-label={removePlaceholderString}\n            vkuiClass=\"Removable__action Removable__action--remove\"\n            onClick={onRemoveClick}\n          >\n            <Icon24Cancel />\n          </IconButton>\n        </div>\n      )}\n\n      {platform === IOS && (\n        <React.Fragment>\n          <div vkuiClass=\"Removable__content\" style={{ transform: `translateX(-${removeOffset}px)` }}>\n            <button\n              type=\"button\"\n              aria-label={removePlaceholderString}\n              vkuiClass=\"Removable__action Removable__action--indicator\"\n              onClick={onRemoveActivateClick}\n            >\n              <i vkuiClass=\"Removable__action-in\" role=\"presentation\" />\n            </button>\n\n            {children}\n\n            <span vkuiClass=\"Removable__offset\" aria-hidden=\"true\"></span>\n          </div>\n\n          <button\n            type=\"button\"\n            tabIndex={isRemoveActivated ? null : -1}\n            ref={removeButtonRef}\n            vkuiClass=\"Removable__action Removable__action--remove\"\n            onClick={onRemoveClick}\n            style={{ transform: `translateX(-${removeOffset}px)` }}\n          >\n            <span vkuiClass=\"Removable__action-in\">{removePlaceholder}</span>\n          </button>\n        </React.Fragment>\n      )}\n    </div>\n  );\n}, {\n  sizeY: true,\n});\n\nRemovable.defaultProps = {\n  align: 'center',\n  removePlaceholder: 'Удалить',\n};\n"]},"metadata":{},"sourceType":"module"}